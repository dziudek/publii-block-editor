(function(e){function t(t){for(var i,a,r=t[0],c=t[1],l=t[2],d=0,h=[];d<r.length;d++)a=r[d],o[a]&&h.push(o[a][0]),o[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);u&&u(t);while(h.length)h.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],i=!0,r=1;r<n.length;r++){var c=n[r];0!==o[c]&&(i=!1)}i&&(s.splice(t--,1),e=a(a.s=n[0]))}return e}var i={},o={app:0},s=[];function a(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var u=c;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0765":function(e,t){const n=[{icon:"paragraph",name:"Paragraph",type:"publii-paragraph",convert:function(e,t,n){let i=n.extensions.conversionHelpers.stripTags(t).replace(/\n/gim,"<br>"),o={textAlign:"left",advanced:{style:"",cssClasses:e.advanced.cssClasses,id:e.advanced.id}};return{content:i,config:o}}}];e.exports=n},"0784":function(e,t){const n=[{icon:"paragraph",name:"Paragraph",type:"publii-paragraph",convert:function(e,t,n){let i={textAlign:"left",advanced:{style:"",cssClasses:e.advanced.cssClasses,id:e.advanced.id}};return{content:t.text,config:i}}},{icon:"html",name:"HTML",type:"publii-html",convert:function(e,t,n,i){let o=t,s={advanced:{cssClasses:e.advanced.cssClasses,id:e.advanced.id}};return{content:o,config:s}}}];e.exports=n},"14f1":function(e,t,n){"use strict";var i=n("ad08"),o=n.n(i);o.a},2533:function(e,t,n){},"27d2":function(e,t,n){},2871:function(e,t,n){},"34c4":function(e,t,n){"use strict";var i=n("6422"),o=n.n(i);o.a},3708:function(e,t,n){"use strict";var i=n("9901"),o=n.n(i);o.a},3873:function(e,t,n){"use strict";var i=n("621e"),o=n.n(i);o.a},"3c7d":function(e,t,n){"use strict";var i=n("bcbe"),o=n.n(i);o.a},"49df":function(e,t,n){"use strict";var i=n("ded4"),o=n.n(i);o.a},"4a13":function(e,t){const n=[{icon:"html",name:"HTML",type:"publii-html",convert:function(e,t,n,i){let o=i.innerHTML,s={advanced:{cssClasses:e.advanced.cssClasses,id:e.advanced.id}};return{content:o,config:s}}}];e.exports=n},"4ac6":function(e,t,n){},"4cee":function(e,t,n){},"54d7":function(e){e.exports=[{name:"cssClasses",type:"text",label:"CSS class",tooltip:"This CSS classes will be added as the class attribute of the field",defaultValue:""},{name:"id",type:"text",label:"ID",tooltip:"This value will be used as ID of the paragraph",defaultValue:""}]},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var i,o,s,a,r,c,l,u,d=n("2b0e"),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"publii-block-editor"}},[n("block-editor",{ref:"block-editor"})],1)},p=[],f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"editor-main",staticClass:"editor",attrs:{"data-ui-opened-block":""},on:{click:function(t){return e.$bus.$emit("block-editor-deselect-blocks")}}},[e.state.externalComponentsLoaded?n("div",{staticClass:"editor-inner"},[e._l(e.content,function(t){return n("block-wrapper",{key:"block-wrapper-"+t.id,ref:"block-wrapper-"+t.id,refInFor:!0,attrs:{id:t.id,"block-type":t.type}},[n(t.type,{key:"block-"+t.id,ref:"block-"+t.id,refInFor:!0,tag:"component",attrs:{id:t.id,inputConfig:t.config,inputContent:t.content,editor:e.$self}})],1)}),n("div",{staticClass:"editor-inner-trigger",on:{click:e.addNewParagraphAtEnd}})],2):e._e(),n("block-advanced-config"),n("block-link-popup")],1)},b=[],g=n("5d73"),m=n.n(g),k=(n("a481"),n("e814")),v=n.n(k),$=n("f499"),C=n.n($),w=(n("20d6"),n("7f7f"),n("5176")),y=n.n(w),x=n("a4bb"),I=n.n(x),T={name:"AdvancedConfig",mounted:function(){this.$bus.$on("block-editor-save-advanced-config",this.saveAdvancedConfig),this.$bus.$on("block-editor-trigger-advanced-config",this.showAdvancedConfig)},methods:{getAdvancedConfigDefaultValue:function(e){var t=this.configForm.findIndex(function(t){return t.name===e});return this.configForm[t].defaultValue},saveAdvancedConfig:function(e,t){if(e===this.id){var n=I()(t),i=!0,o=!1,s=void 0;try{for(var a,r=m()(n);!(i=(a=r.next()).done);i=!0){var c=a.value;this.config.advanced[c]=t[c]}}catch(l){o=!0,s=l}finally{try{i||null==r.return||r.return()}finally{if(o)throw s}}this.save()}},showAdvancedConfig:function(e){e===this.id&&this.$bus.$emit("block-editor-show-advanced-config",this.id,this.config.advanced,this.configForm)}},beforeDestroy:function(){this.$bus.$off("block-editor-save-advanced-config",this.saveAdvancedConfig),this.$bus.$off("block-editor-trigger-advanced-config",this.showAdvancedConfig)}},A=T,S=n("2877"),B=Object(S["a"])(A,i,o,!1,null,null,null),L=B.exports,P={name:"Block",mixins:[L],props:["id","inputContent","inputConfig","editor"],data:function(){return{caretIsAtStart:!1,caretIsAtEnd:!1,textIsHighlighted:!1}},mounted:function(){this.config=y()(this.config,this.inputConfig),this.$on("block-save",this.save),this.$bus.$on("block-editor-trigger-block-save",this.saveIsNeeded),this.$bus.$on("block-editor-clear-text-selection",this.clearTextSelection)},methods:{focus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"end",t=this.getFocusableElement();document.activeElement!==this.$refs[t]&&document.activeElement.parentNode!==this.$refs[t].parentNode&&this.$refs[t].focus&&(this.$refs[t].focus(),"none"!==e&&("end"===e&&this.setCursorAtEndOfElement(t,this.isContentEditable(t)),"number"===typeof e&&this.setCursorAtPosition(e)))},isContentEditable:function(e){var t=["INPUT","SELECT","TEXTAREA"];return!(t.indexOf(this.$refs[e].tagName)>-1)},getFocusableElement:function(){if(this.focusable){var e=this.focusable[0];return e}return"block"},setCursorAtPosition:function(e){var t=this.$refs[this.getFocusableElement()],n=document.createRange(),i=document.getSelection();n.setStart(t.firstChild,e),n.setEnd(t.firstChild,e),i.removeAllRanges(),i.addRange(n)},getCaretPosition:function(e){var t,n=window.getSelection().getRangeAt(0),i=n.cloneRange(),o=document.createElement("div");return i.selectNodeContents(e),i.setEnd(n.endContainer,n.endOffset),o.appendChild(i.cloneContents()),t=o.innerHTML.length,t},getHtmlCaretPosition:function(e){var t=this.getCaretPosition(e),n=e.innerHTML,i=0,o=0,s=!1,a=["&","<"],r=[";",">"];if(0===t)return 0;while(i<t){o++;while(a.indexOf(n.charAt(o))>-1){s=!0;while(s)r.indexOf(n.charAt(o))>-1&&(";"===n.charAt(o)&&o--,s=!1),o++}i++}return o},getCursorPosition:function(e){return this.getHtmlCaretPosition(this.$refs[e])},setCursorAtEndOfElement:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block",n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(n){var i=document.createRange();i.selectNodeContents(this.$refs[t]),i.collapse(!1);var o=document.getSelection();o.removeAllRanges(),o.addRange(i)}else{var s=this.$refs[t].value;setTimeout(function(){e.$refs[t].focus&&(e.$refs[t].focus(),e.$refs[t].setSelectionRange(s.length,s.length))},0)}},handleCaret:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block",n=this.getCursorPosition(t);if("ArrowUp"===e.code&&(n<=2||n===this.$refs[t].innerHTML.length||n<=15&&"List"===this.$options.name)){if(!this.caretIsAtStart)return void(this.caretIsAtStart=!0);var i=this.findPreviousBlockID();i&&(this.editor.$refs["block-wrapper-"+i][0].blockClick(),this.editor.$refs["block-"+i][0].focus&&this.editor.$refs["block-"+i][0].focus())}if("ArrowDown"===e.code&&(n>=this.$refs[t].innerHTML.length-5||0===n&&"Separator"===this.$options.name||0===n&&"ReadMore"===this.$options.name)){if(!this.caretIsAtEnd)return void(this.caretIsAtEnd=!0);var o=this.findNextBlockID();o&&(this.editor.$refs["block-wrapper-"+o][0].blockClick(),this.editor.$refs["block-"+o][0].focus("none"))}"ArrowDown"!==e.code&&"ArrowUp"!==e.code||(this.caretIsAtStart=!1,this.caretIsAtEnd=!1)},getFocusFromTab:function(e){"Tab"===e.code&&this.focus()},pastePlainText:function(e){e.preventDefault();var t=(e.originalEvent||e).clipboardData.getData("text/plain");t=t.replace(/\n/gim,"<br>"),document.execCommand("insertHTML",!1,t)},saveIsNeeded:function(e){this.id===e&&this.save()},findNextBlockID:function(){var e=this,t=this.editor.content.findIndex(function(t){return t.id===e.id});return t++,t<this.editor.content.length&&this.editor.content[t].id},findPreviousBlockID:function(){var e=this,t=this.editor.content.findIndex(function(t){return t.id===e.id});return!!t&&(t--,this.editor.content[t].id)},clearTextSelection:function(e){this.id===e&&(window.getSelection().empty(),this.textIsHighlighted=!1)}},beforeDestroy:function(){this.$off("block-save",this.save),this.$bus.$off("block-editor-trigger-block-save",this.saveIsNeeded),this.$bus.$off("block-editor-clear-text-selection",this.clearTextSelection)}},_=P,M=Object(S["a"])(_,s,a,!1,null,null,null),D=M.exports,E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{"block-advanced-config-overlay":!0,"is-visible":e.isVisible},on:{click:function(t){return t.stopPropagation(),e.hide()}}},[n("div",{ref:"form",staticClass:"block-advanced-config",on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[e._l(e.configForm,function(t,i){return n("div",{key:"field-"+i,staticClass:"block-advanced-config-field"},[n("label",{attrs:{for:"advanced-config-field-"+i,title:""!==t.tooltip?t.tooltip:""}},[e._v("\n        "+e._s(t.label)+"\n        "),""!==t.tooltip?n("span",{staticClass:"block-advanced-config-field-help"},[e._v("?")]):e._e()]),"text"===t.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.config[t.name],expression:"config[field.name]"}],key:"field-input-"+i,attrs:{id:"advanced-config-field-"+i,type:"text",disabled:e.getDisabledState(t.disabled)},domProps:{value:e.config[t.name]},on:{input:function(n){n.target.composing||e.$set(e.config,t.name,n.target.value)}}}):e._e(),"checkbox"===t.type?n("switcher",{key:"field-input-"+i,attrs:{id:"advanced-config-field-"+i,disabled:e.getDisabledState(t.disabled)},model:{value:e.config[t.name],callback:function(n){e.$set(e.config,t.name,n)},expression:"config[field.name]"}}):e._e(),"select"===t.type?n("select",{directives:[{name:"model",rawName:"v-model",value:e.config[t.name],expression:"config[field.name]"}],key:"field-input-"+i,attrs:{id:"advanced-config-field-"+i,"blockData.config.advanced.style":""},on:{change:function(n){var i=Array.prototype.filter.call(n.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.config,t.name,n.target.multiple?i:i[0])}}},[n("option",{attrs:{value:""}},[e._v("- Select -")]),e._l(t.values,function(t,i){return n("option",{key:"option-"+i,domProps:{value:t.value}},[e._v("\n          "+e._s(t.label)+"\n        ")])})],2):e._e()],1)}),n("div",{staticClass:"block-advanced-config-buttons"},[n("button",{on:{click:function(t){return e.save()}}},[e._v("\n        Save\n      ")]),n("button",{staticClass:"outline",on:{click:function(t){return e.hide()}}},[e._v("\n        Cancel\n      ")])])],2)])},O=[],H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{class:e.cssClasses,on:{click:e.toggle}})},V=[],N=(n("c5f6"),{name:"switcher",props:{value:{type:[Boolean,Number]},isMini:{default:!1,type:Boolean},checked:{default:!1,type:Boolean},onToggle:{default:function(){return!1},type:Function},disabled:{default:!1,type:Boolean},lowerZindex:{default:!1,type:Boolean}},data:function(){return{isChecked:this.checked}},computed:{cssClasses:function(){return{switcher:!0,"is-checked":this.isChecked,"lower-zindex":this.lowerZindex,"is-disabled":this.disabled,"is-mini":this.isMini}}},watch:{value:function(e,t){this.isChecked=!!e}},mounted:function(){this.value&&(this.isChecked=!!this.value)},methods:{toggle:function(){this.isChecked=!this.isChecked,this.$emit("input",this.isChecked),this.onToggle(this.isChecked)},getValue:function(){return!!this.isChecked}}}),U=N,F=(n("dbd0"),Object(S["a"])(U,H,V,!1,null,"3e9c8ff5",null)),j=F.exports,K={name:"block-advanced-config",components:{switcher:j},data:function(){return{isVisible:!1,currentBlockID:"",config:{},configForm:[]}},mounted:function(){this.$bus.$on("block-editor-show-advanced-config",this.show)},methods:{show:function(e,t,n){var i=this;this.isVisible=!0,this.currentBlockID=e,this.config=JSON.parse(C()(t)),this.configForm=n,setTimeout(function(){i.$refs["form"].querySelector(".block-advanced-config-field").querySelector("input").focus()},100)},hide:function(){var e=this;this.isVisible=!1,setTimeout(function(){e.currentBlockID="",e.config={},e.configForm=[]},500)},save:function(){this.$bus.$emit("block-editor-save-advanced-config",this.currentBlockID,this.config),this.hide()},getDisabledState:function(e){if("undefined"===typeof e)return!1;var t=!0,n=!1,i=void 0;try{for(var o,s=m()(e);!(t=(o=s.next()).done);t=!0){var a=o.value;if(this.config[a.field]===a.value)return!0}}catch(r){n=!0,i=r}finally{try{t||null==s.return||s.return()}finally{if(n)throw i}}return!1}},beforeDestroy:function(){this.$bus.$off("block-editor-show-advanced-config",this.show)}},R=K,q=(n("f23b"),Object(S["a"])(R,E,O,!1,null,null,null)),J=q.exports,W=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{"block-link-popup-overlay":!0,"is-visible":e.isVisible},on:{click:function(t){return t.stopPropagation(),e.hide()}}},[n("div",{staticClass:"block-link-popup",on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[n("div",{staticClass:"block-link-popup-link-type"},[n("div",{class:{"block-link-popup-link-type-item":!0,"is-active":"post"===e.linkType},on:{click:function(t){return e.setLinkType("post")}}},[e._v("\n        Post\n      ")]),n("div",{class:{"block-link-popup-link-type-item":!0,"is-active":"tag"===e.linkType},on:{click:function(t){return e.setLinkType("tag")}}},[e._v("\n        Tag\n      ")]),n("div",{class:{"block-link-popup-link-type-item":!0,"is-active":"author"===e.linkType},on:{click:function(t){return e.setLinkType("author")}}},[e._v("\n        Author\n      ")]),n("div",{class:{"block-link-popup-link-type-item":!0,"is-active":"external"===e.linkType},on:{click:function(t){return e.setLinkType("external")}}},[e._v("\n        External\n      ")])]),"post"===e.linkType?n("vue-select",{ref:"postPagesSelect",attrs:{slot:"field",options:e.postPages,"custom-label":e.customPostLabels,"close-on-select":!0,"show-labels":!1,placeholder:"Select post page"},slot:"field",model:{value:e.linkSelectedPost,callback:function(t){e.linkSelectedPost=t},expression:"linkSelectedPost"}}):e._e(),"tag"===e.linkType?n("vue-select",{ref:"tagPagesSelect",attrs:{slot:"field",options:e.tagPages,"custom-label":e.customTagLabels,"close-on-select":!0,"show-labels":!1,placeholder:"Select tag page"},slot:"field",model:{value:e.linkSelectedTag,callback:function(t){e.linkSelectedTag=t},expression:"linkSelectedTag"}}):e._e(),"author"===e.linkType?n("vue-select",{ref:"authorPagesSelect",attrs:{slot:"field",options:e.authorPages,"custom-label":e.customAuthorsLabels,"close-on-select":!0,"show-labels":!1,placeholder:"Select author page"},slot:"field",model:{value:e.linkSelectedAuthor,callback:function(t){e.linkSelectedAuthor=t},expression:"linkSelectedAuthor"}}):e._e(),"external"===e.linkType?n("input",{directives:[{name:"model",rawName:"v-model",value:e.link.url,expression:"link.url"}],staticClass:"block-link-popup-link-external-input",attrs:{type:"text",placeholder:"https://example.com"},domProps:{value:e.link.url},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.save()},input:function(t){t.target.composing||e.$set(e.link,"url",t.target.value)}}}):e._e(),n("div",{staticClass:"block-link-popup-link-switcher"},[n("switcher",{model:{value:e.link.targetBlank,callback:function(t){e.$set(e.link,"targetBlank",t)},expression:"link.targetBlank"}}),e._v("\n      Open in new tab\n    ")],1),n("div",{staticClass:"block-link-popup-link-switcher"},[n("switcher",{model:{value:e.link.nofollow,callback:function(t){e.$set(e.link,"nofollow",t)},expression:"link.nofollow"}}),e._v('\n      Add rel="nofollow" attribute\n    ')],1),n("div",{staticClass:"block-link-popup-buttons"},[n("button",{on:{click:function(t){return e.save()}}},[e._v("\n        Save\n      ")]),n("button",{staticClass:"outline",on:{click:function(t){return e.hide()}}},[e._v("\n        Cancel\n      ")])])],1)])},z=[],G=(n("28a5"),n("b54a"),n("55dd"),{name:"link-helpers",computed:{tagPages:function(){return this.$store?this.$store.state.currentSite.tags.map(function(e){return e.id}):[1]},authorPages:function(){return this.$store?this.$store.state.currentSite.authors.map(function(e){return e.username}).sort(function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}):["test author"]},postPages:function(){return this.$store?this.$store.state.currentSite.posts.map(function(e){return e.id}):[1]}},methods:{linkIsInvalid:function(e){return-1===e.indexOf("http://")&&-1===e.indexOf("https://")&&-1===e.indexOf("://")&&-1===e.indexOf("dat://")&&-1===e.indexOf("ipfs://")&&0!==e.indexOf("//")&&0!==e.indexOf("#")},customTagLabels:function(e){return this.$store?this.$store.state.currentSite.tags.filter(function(t){return t.id===e}).map(function(e){return e.name})[0]:"Test tag"},customAuthorsLabels:function(e){return this.$store?this.$store.state.currentSite.authors.filter(function(t){return t.username===e}).map(function(e){return e.name})[0]:"Test author"},customPostLabels:function(e){return this.$store?this.$store.state.currentSite.posts.filter(function(t){return t.id===e}).map(function(e){return e.title})[0]:"Test post"}}}),Q=G,Z=Object(S["a"])(Q,r,c,!1,null,null,null),Y=Z.exports,X=n("8e5f"),ee=n.n(X),te={name:"block-link-popup",mixins:[Y],components:{switcher:j,"vue-select":ee.a},data:function(){return{isVisible:!1,currentBlockID:"",linkType:"post",linkSelectedAuthor:"",linkSelectedPost:"",linkSelectedTag:"",link:{url:"",noFollow:!1,targetBlank:!1}}},mounted:function(){this.$bus.$on("block-editor-show-link-popup",this.show)},methods:{show:function(e,t){this.isVisible=!0,this.currentBlockID=e,this.link=JSON.parse(C()(t)),this.parseLink()},hide:function(){var e=this;this.isVisible=!1,setTimeout(function(){e.currentBlockID=""},500)},parseLink:function(){""!==this.link.url?this.link.url.indexOf("#INTERNAL_LINK#")>-1?this.link.url.indexOf("POST")>-1?(this.linkType="post",this.linkSelectedPost=v()(this.link.url.split("/").pop(),10)):this.link.url.indexOf("TAG")>-1?(this.linkType="tag",this.linkSelectedTag=v()(this.link.url.split("/").pop(),10)):this.link.url.indexOf("AUTHOR")>-1&&(this.linkType="author",this.linkSelectedAuthor=v()(this.link.url.split("/").pop(),10)):this.linkType="external":this.linkType="post"},setLinkType:function(e){this.linkType=e},prepareLink:function(){return"post"===this.linkType?"#INTERNAL_LINK#/POST/"+this.linkSelectedPost:"author"===this.linkType?"#INTERNAL_LINK#/AUTHOR/"+this.linkSelectedAuthor:"tag"===this.linkType?"#INTERNAL_LINK#/TAG/"+this.linkSelectedTag:this.link.url},save:function(){this.link.url=this.prepareLink(),this.$bus.$emit("block-editor-save-link-popup",this.currentBlockID,this.link),this.hide()}},beforeDestroy:function(){this.$bus.$off("block-editor-show-link-popup",this.show)}},ne=te,ie=(n("3873"),Object(S["a"])(ne,W,z,!1,null,null,null)),oe=ie.exports,se=function(){var e,t=this,n=t.$createElement,i=t._self._c||n;return i("div",{ref:"block-wrapper",class:(e={wrapper:!0,"is-selected":t.isSelected,"has-ui-opened":t.uiOpened},e[t.customCssClasses.join(" ")]=!0,e),attrs:{"data-block-type":t.blockType},on:{click:function(e){return e.stopPropagation(),t.blockClick(e)}}},[t._t("default"),i("div",{staticClass:"wrapper-ui"},[i("div",{class:{"wrapper-ui-show-options":!0},on:{click:function(e){return e.stopPropagation(),t.togglePopup(e)}}},[i("button",{class:{"wrapper-ui-show-options-button":!0,"is-visible":t.isSelected&&!t.uiOpened}},[i("icon",{attrs:{color:"#5da4ef",name:"dotted-line"}})],1),t.uiOpened?i("div",{class:{"wrapper-ui-options":!0,"is-visible":!0}},[i("button",{staticClass:"wrapper-ui-options-button-move",attrs:{tabindex:"-1"},on:{click:function(e){return e.stopPropagation(),t.moveUp(e)}}},[i("icon",{attrs:{name:"up"}})],1),i("button",{staticClass:"wrapper-ui-options-button-move",attrs:{tabindex:"-1"},on:{click:function(e){return e.stopPropagation(),t.moveDown(e)}}},[i("icon",{attrs:{name:"down"}})],1)]):t._e()])])],2)},ae=[],re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{style:e.style,attrs:{width:e.width,height:e.height}},[n("use",{attrs:{"xlink:href":e.iconPath}})])},ce=[],le={name:"editor-icon",props:{name:{default:"",type:String},color:{default:"currentColor",type:String},customWidth:{default:"",type:String},customHeight:{default:"",type:String}},computed:{width:function(){if(""!==this.customWidth)return this.customWidth;switch(this.name){case"add":return 12;case"headings":return 10;case"image":return 18;case"gallery":return 26;case"unordered-list":return 16;case"quote":return 14;case"code":return 14;case"table":return 18;case"html":return 18;case"separator":return 16;case"readmore":return 16;case"video":return 18;case"toc":return 16;case"menu":return 15;case"tab":return 9;case"bold":return 11;case"italic":return 10;case"underline":return 10;case"strikethrough":return 12;case"link":return 13;case"unlink":return 15;case"marker":return 16;case"align-left":return 14;case"align-right":return 14;case"align-center":return 14;case"paragraph":return 14;case"h1":return 16;case"h2":return 19;case"h3":return 20;case"h4":return 20;case"h5":return 18;case"h6":return 18;case"ordered-list":return 17;case"nesting":return 17;case"flattening":return 17;case"long-line":return 20;case"shorter-line":return 16;case"short-line":return 8;case"dotted-line":return 17;case"dot":return 3;case"preview":return 19;case"left":return 14;case"center":return 14;case"right":return 14;case"wide":return 14;case"full":return 14;case"enter":return 11;case"down":return 10;case"up":return 10;case"trash":return 11;case"open-trash":return 12;case"gear":return 13}return"16"},height:function(){if(""!==this.customHeight)return this.customHeight;switch(this.name){case"add":return 12;case"headings":return 14;case"image":return 14;case"gallery":return 14;case"unordered-list":return 12;case"quote":return 12;case"code":return 12;case"table":return 14;case"html":return 12;case"separator":return 2;case"readmore":return 12;case"video":return 14;case"toc":return 12;case"menu":return 3;case"tab":return 5;case"bold":return 13;case"italic":return 13;case"underline":return 14;case"strikethrough":return 14;case"link":return 13;case"unlink":return 15;case"marker":return 13;case"align-left":return 12;case"align-right":return 12;case"align-center":return 12;case"paragraph":return 14;case"h1":return 12;case"h2":return 12;case"h3":return 12;case"h4":return 12;case"h5":return 12;case"h6":return 12;case"ordered-list":return 14;case"nesting":return 12;case"flattening":return 12;case"long-line":return 2;case"shorter-line":return 2;case"short-line":return 2;case"dotted-line":return 4;case"dot":return 3;case"preview":return 12;case"left":return 13;case"center":return 13;case"right":return 13;case"wide":return 13;case"full":return 13;case"enter":return 13;case"down":return 6;case"up":return 6;case"trash":return 12;case"open-trash":return 14;case"gear":return 13}return"16"},style:function(){var e=[];return e.push("fill: ".concat(this.color)),e.join(";")},iconPath:function(){return window.process?"../node_modules/publii-block-editor/public/assets/svg/editor-ui-svg-map.svg#".concat(this.name):"../assets/svg/editor-ui-svg-map.svg#".concat(this.name)}}},ue=le,de=Object(S["a"])(ue,re,ce,!1,null,null,null),he=de.exports,pe={name:"BlockWrapper",props:["id","blockType"],components:{icon:he},data:function(){return{customCssClasses:[],isSelected:!1,uiOpened:!1}},watch:{uiOpened:function(e,t){e?this.$bus.$emit("block-editor-ui-opened-for-block",this.id):this.$bus.$emit("block-editor-ui-closed-for-block",this.id)}},mounted:function(){this.$bus.$on("block-editor-deselect-blocks",this.deselectBlock)},methods:{blockClick:function(){this.$bus.$emit("block-editor-deselect-blocks",this.id),this.uiOpened=!1,this.setSelectionState(!0)},deselectBlock:function(e){e!==this.id&&this.setSelectionState(!1)},togglePopup:function(){this.uiOpened=!this.uiOpened,this.uiOpened&&(this.$bus.$emit("block-editor-clear-text-selection",this.id),"publii-paragraph"===this.blockType&&this.$bus.$emit("block-editor-close-new-block-ui",this.id))},setSelectionState:function(e){this.isSelected&&!1===e&&this.$bus.$emit("block-editor-trigger-block-save",this.id),this.isSelected=e,this.isSelected||(this.uiOpened=!1),e&&this.$bus.$emit("block-editor-block-selected",this.id)},addCustomCssClass:function(e){-1===this.customCssClasses.indexOf(e)&&this.customCssClasses.push(e)},removeCustomCssClass:function(e){this.customCssClasses.indexOf(e)>-1&&(this.customCssClasses=this.customCssClasses.filter(function(t){return t!==e}))},moveUp:function(){var e=this.$refs["block-wrapper"].getBoundingClientRect().top;this.$bus.$emit("block-editor-move-block-up",this.id,e)},moveDown:function(){var e=this.$refs["block-wrapper"].getBoundingClientRect().top;this.$bus.$emit("block-editor-move-block-down",this.id,e)}},beforeDestroy:function(){this.$bus.$off("block-editor-deselect-blocks",this.deselectBlock)}},fe=pe,be=(n("6dbe"),Object(S["a"])(fe,se,ae,!1,null,null,null)),ge=be.exports,me={name:"ContentEditableImprovements"},ke=me,ve=(n("e19f"),Object(S["a"])(ke,l,u,!1,null,null,null)),$e=ve.exports,Ce=n("5ce8"),we=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("prism-editor",{ref:"block",class:{"publii-block-code":!0},attrs:{code:e.content,emitEvents:!0,lineNumbers:!0,language:e.config.language},on:{paste:e.pastePlainText,keyup:e.handleKeyboard},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),n("div",{staticClass:"publii-block-code-lang"},[n("vue-select",{attrs:{options:e.availableLanguages},model:{value:e.config.language,callback:function(t){e.$set(e.config,"language",t)},expression:"config.language"}})],1),n("top-menu",{ref:"top-menu",attrs:{conversions:e.conversions,config:[]}})],1)},ye=[],xe=n("98b9"),Ie=n.n(xe),Te=n("54d7"),Ae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isVisible?n("div",{staticClass:"wrapper-ui-top-menu",on:{click:e.resetDeleteConfirmation}},[e.conversions.length?e._e():n("span",{staticClass:"wrapper-ui-top-menu-title"},[e._v("\n    Edit block\n  ")]),e.conversions.length?n("span",{staticClass:"wrapper-ui-top-menu-title wrapper-ui-top-menu-conversions"},[e._v("\n    Convert to:\n    "),e._l(e.conversions,function(t,i){return n("span",{key:"conversion-"+i,staticClass:"wrapper-ui-top-menu-conversion",on:{click:function(n){e.makeConversion(t.type,t.convert),e.resetDeleteConfirmation()}}},[n("icon",{attrs:{name:t.icon}}),n("span",{staticClass:"wrapper-ui-top-menu-conversion-tooltip"},[e._v("\n        "+e._s(t.name)+"\n      ")])],1)})],2):e._e(),e._l(e.filteredConfig,function(t,i){return n("button",{key:"top-menu-button-"+i,class:{"wrapper-ui-top-menu-button":!0,"is-active":t.activeState.bind(e.$parent)()},attrs:{tabindex:"-1"},on:{click:function(n){n.stopPropagation(),t.onClick.bind(e.$parent)(),e.resetDeleteConfirmation()}}},[n("icon",{attrs:{name:t.icon}})],1)}),"publii-readmore"!==e.$parent.$parent.blockType?n("button",{staticClass:"wrapper-ui-top-menu-button",attrs:{tabindex:"-1"},on:{click:function(t){t.stopPropagation(),e.showAdvancedConfig(),e.resetDeleteConfirmation()}}},[n("icon",{attrs:{name:"gear"}})],1):e._e(),e.confirmDelete?e._e():n("button",{staticClass:"wrapper-ui-top-menu-button",attrs:{tabindex:"-1"},on:{click:function(t){return t.stopPropagation(),e.deleteBlock(t)}}},[n("icon",{attrs:{name:"trash"}})],1),e.confirmDelete?n("button",{staticClass:"wrapper-ui-top-menu-button top-menu-button-trash is-active",attrs:{tabindex:"-1"},on:{click:function(t){return t.stopPropagation(),e.deleteBlock(t)}}},[n("icon",{attrs:{name:"open-trash"}})],1):e._e()],2):e._e()},Se=[],Be={name:"top-menu-ui",props:{config:{type:Array,default:function(){return[]}},conversions:{type:Array,default:function(){return[]}}},components:{icon:he},computed:{filteredConfig:function(){return this.config.filter(function(e){return"undefined"===typeof e.isVisible||e.isVisible()})},isVisible:function(){return this.$parent.$parent.uiOpened&&!this.$parent.textIsHighlighted}},watch:{isVisible:function(e){e&&(this.confirmDelete=!1)}},data:function(){return{confirmDelete:!1}},methods:{makeConversion:function(e,t){var n=t(this.$parent.config,this.$parent.content,this.$parent.editor,this.$parent.$refs["block"]);this.$bus.$emit("block-editor-convert-block",this.$parent.id,e,n)},deleteBlock:function(){this.confirmDelete?this.$bus.$emit("block-editor-delete-block",this.$parent.id):this.confirmDelete=!0},showAdvancedConfig:function(){this.$bus.$emit("block-editor-trigger-advanced-config",this.$parent.id)},resetDeleteConfirmation:function(){this.confirmDelete=!1}}},Le=Be,Pe=(n("34c4"),Object(S["a"])(Le,Ae,Se,!1,null,null,null)),_e=Pe.exports,Me={name:"Code",mixins:[D,$e],components:{"top-menu":_e,"vue-select":ee.a},data:function(){return{config:{language:"html",advanced:{cssClasses:this.getAdvancedConfigDefaultValue("cssClasses"),id:this.getAdvancedConfigDefaultValue("id")}},content:"",conversions:Ie.a}},computed:{availableLanguages:function(){return["apacheconf","aspnet","bash","basic","batch","c","cpp","csharp","css","dart","docker","elm","git","glsl","go","graphql","haml","handlebars","haskell","html","http","ini","java","javascript","json","jsonp","jsx","kotlin","latex","less","lisp","lua","makefile","markdown","matlab","nasm","nginx","objectivec","pascal","perl","php","pug","python","r","regex","ruby","sass","scss","scala","sql","swift","twig","typescript","vbnet","visual-basic","yaml"]}},beforeCreate:function(){this.configForm=Te},mounted:function(){this.content=this.inputContent},methods:{focus:function(){this.$refs["block"].$el.querySelector("pre").focus()},handleKeyboard:function(e){"Enter"===e.code&&!0===e.shiftKey&&(this.$bus.$emit("block-editor-add-block","publii-paragraph",this.id),e.returnValue=!1),"Tab"===e.code&&!1===e.shiftKey&&(e.preventDefault(),document.execCommand("insertHTML",!1,"  "),e.returnValue=!1),"Backspace"===e.code&&""===this.$refs["block"].code&&(this.$bus.$emit("block-editor-delete-block",this.id),e.returnValue=!1)},save:function(){this.content=this.$refs["block"].code,this.$bus.$emit("block-editor-save-block",{id:this.id,config:JSON.parse(C()(this.config)),content:this.content})}}},De=Me,Ee=(n("3c7d"),Object(S["a"])(De,we,ye,!1,null,null,null)),Oe=Ee.exports,He=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"publii-block-embed-wrapper"},[n("div",{ref:"block",class:{"publii-block-embed":!0,"is-visible":"code"===e.view}},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.content,expression:"content"}],ref:"code",attrs:{placeholder:"Enter URL or embed code..."},domProps:{value:e.content},on:{keydown:e.handleKeyboard,keyup:e.handleCaret,blur:e.save,input:function(t){t.target.composing||(e.content=t.target.value)}}})]),"preview"===e.view?n("div",{class:{"publii-block-embed-preview":!0},domProps:{innerHTML:e._s(e.modifiedContent)}}):e._e(),n("top-menu",{ref:"top-menu",attrs:{config:[]}})],1)},Ve=[],Ne=n("f9d7");let Ue={isEmbedable(e){return!!Ue.getService(e)||!!Ue.isUrl(e)},embed(e){let t=Ue.getService(e),n=Ue.createIframe(t,e);return n},isUrl(e){return"https://"===e.substr(0,8)||"http://"===e.substr(0,7)},getService(e){return"https://"===e.substr(0,8)&&e.indexOf("youtube.com")>-1?"youtube":"https://"===e.substr(0,8)&&e.indexOf("vimeo.com")>-1&&"vimeo"},createIframe(e,t){switch(e){case"youtube":return Ue.youtubeIframe(t);case"vimeo":return Ue.vimeoIframe(t);default:return Ue.rawIframe(t)}},youtubeIframe(e){let t=e,n=new URLSearchParams(t.split("?")[1]);return n.has("v")&&(t="https://www.youtube.com/embed/"+n.get("v")+"?feature=oembed"),'<iframe src="'+t+'" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>'},vimeoIframe(e){let t=e.replace("https://vimeo.com/","");return t="https://player.vimeo.com/video/"+t,'<iframe src="'+t+'" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe>'},rawIframe(e){return'<iframe width="100%" height="500" src="'+e+'" frameborder="0"></iframe>'}};var Fe,je,Ke,Re,qe,Je=Ue,We={name:"has-preview",data:function(){return{view:"code"}},mounted:function(){this.$bus.$on("block-editor-deselect-blocks",this.deselectBlock),this.$bus.$on("block-editor-block-selected",this.selectBlock)},methods:{setView:function(e){var t=this;"code"===this.view&&"preview"===e&&this.save(),""===this.content&&"preview"===e?this.view="code":setTimeout(function(){t.view=e},0)},selectBlock:function(e){var t=this;this.id===e&&(this.setView("code"),setTimeout(function(){t.focus("end")},0))},deselectBlock:function(e){this.id!==e&&this.setView("preview")}},beforeDestroy:function(){this.$bus.$off("block-editor-deselect-blocks",this.deselectBlock),this.$bus.$off("block-editor-block-selected",this.selectBlock)}},ze=We,Ge=Object(S["a"])(ze,Fe,je,!1,null,null,null),Qe=Ge.exports,Ze={name:"Embed",mixins:[D,$e,Qe],components:{"top-menu":_e},data:function(){return{focusable:["code"],config:{advanced:{cssClasses:this.getAdvancedConfigDefaultValue("cssClasses"),id:this.getAdvancedConfigDefaultValue("id")}},content:""}},computed:{modifiedContent:function(){return Je.isEmbedable(this.content)?Je.embed(this.content,this.$bus,this.id):this.content}},beforeCreate:function(){this.configForm=Ne},mounted:function(){this.content=this.inputContent,this.view=""===this.content?"code":"preview"},methods:{handleKeyboard:function(e){"Enter"===e.code&&!1===e.shiftKey&&(this.$bus.$emit("block-editor-add-block","publii-paragraph",this.id),e.returnValue=!1),"Tab"===e.code&&!1===e.shiftKey&&(e.preventDefault(),document.execCommand("insertHTML",!1,"  "),e.returnValue=!1),"Backspace"===e.code&&""===this.content&&(this.$bus.$emit("block-editor-delete-block",this.id),e.returnValue=!1)},save:function(){this.$bus.$emit("block-editor-save-block",{id:this.id,config:JSON.parse(C()(this.config)),content:this.content})}}},Ye=Ze,Xe=(n("e98d"),Object(S["a"])(Ye,He,Ve,!1,null,null,null)),et=Xe.exports,tt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h"+e.config.headingLevel,{ref:"block",tag:"component",class:{"publii-block-header":!0,"is-link":""!==e.config.link.url},style:"text-align: "+e.config.textAlign+";",attrs:{contenteditable:"true",title:""!==e.config.link.url?e.config.link.url:""},domProps:{innerHTML:e._s(e.content)},on:{keyup:function(t){e.getFocusFromTab(t),e.handleCaret(t)},keydown:e.handleKeyboard,paste:e.pastePlainText,blur:e.save}}),n("top-menu",{ref:"top-menu",attrs:{conversions:e.conversions,config:e.topMenuConfig}})],1)},nt=[],it=n("cb24"),ot=n.n(it),st=n("7ce2"),at={name:"LinkConfig",mounted:function(){this.$bus.$on("block-editor-save-link-popup",this.saveLinkConfig)},methods:{saveLinkConfig:function(e,t){e===this.id&&(this.config.link=JSON.parse(C()(t)),this.save())},showLinkPopup:function(){if(this.config.link)this.$bus.$emit("block-editor-show-link-popup",this.id,this.config.link);else{var e={url:"",noFollow:!1,targetBlank:!1};this.$bus.$emit("block-editor-show-link-popup",this.id,e)}},removeLink:function(){this.config.link={url:"",noFollow:!1,targetBlank:!1}}},beforeDestroy:function(){this.$bus.$off("block-editor-save-link-popup",this.saveLinkConfig)}},rt=at,ct=Object(S["a"])(rt,Ke,Re,!1,null,null,null),lt=ct.exports;if(window.app&&window.remote){var ut=n("bdb9"),dt=ut.remote;qe=dt.require("./main.js")}else qe={slug:function(e){return e.toLowerCase().replace(/[^a-zA-Z0-9\s]/gim,"").replace(/\s/gim,"-").trim()}};var ht,pt,ft={name:"Header",mixins:[D,$e,lt],components:{"top-menu":_e},data:function(){var e=this;return{config:{headingLevel:2,textAlign:"left",link:{url:"",noFollow:!1,targetBlank:!1},advanced:{cssClasses:this.getAdvancedConfigDefaultValue("cssClasses"),customId:this.getAdvancedConfigDefaultValue("customId"),id:this.getAdvancedConfigDefaultValue("id")}},content:"",conversions:ot.a,topMenuConfig:[{activeState:function(){return 1===this.config.headingLevel},onClick:function(){this.setHeadingLevel(1)},icon:"h1"},{activeState:function(){return 2===this.config.headingLevel},onClick:function(){this.setHeadingLevel(2)},icon:"h2"},{activeState:function(){return 3===this.config.headingLevel},onClick:function(){this.setHeadingLevel(3)},icon:"h3"},{activeState:function(){return 4===this.config.headingLevel},onClick:function(){this.setHeadingLevel(4)},icon:"h4"},{activeState:function(){return 5===this.config.headingLevel},onClick:function(){this.setHeadingLevel(5)},icon:"h5"},{activeState:function(){return 6===this.config.headingLevel},onClick:function(){this.setHeadingLevel(6)},icon:"h6"},{activeState:function(){return"left"===this.config.textAlign},onClick:function(){this.alignText("left")},icon:"align-left"},{activeState:function(){return"center"===this.config.textAlign},onClick:function(){this.alignText("center")},icon:"align-center"},{activeState:function(){return"right"===this.config.textAlign},onClick:function(){this.alignText("right")},icon:"align-right"},{activeState:function(){return""!==e.config.link.url},onClick:this.showLinkPopup,icon:"link"},{activeState:function(){return!1},onClick:this.removeLink,isVisible:function(){return""!==e.config.link.url},icon:"unlink"}]}},beforeCreate:function(){this.configForm=st},mounted:function(){this.content=this.inputContent,this.config.headingLevel=this.inputConfig.headingLevel||2},methods:{handleKeyboard:function(e){if("Enter"===e.code&&!1===e.shiftKey){if(document.execCommand("insertHTML",!1,"<line-separator />"),"<line-separator></line-separator>"===this.$refs["block"].innerHTML.substr(-33))this.$bus.$emit("block-editor-add-block","publii-paragraph",this.id),this.$refs["block"].innerHTML=this.$refs["block"].innerHTML.replace("<line-separator></line-separator>","");else{var t=this.$refs["block"].innerHTML.split("<line-separator></line-separator>"),n=t[0],i=t[1];"<br>"===i.substr(0,4)&&(i=i.substr(4)),this.$refs["block"].innerHTML=n,this.$bus.$emit("block-editor-add-block","publii-paragraph",this.id,i)}e.returnValue=!1}"Backspace"===e.code&&""===this.$refs["block"].innerHTML&&(this.$bus.$emit("block-editor-delete-block",this.id),e.returnValue=!1)},alignText:function(e){this.config.textAlign=e},setHeadingLevel:function(e){this.save(),this.config.headingLevel=e,this.save()},save:function(){this.content=this.$refs["block"].innerHTML.replace("<line-separator></line-separator>",""),this.config.advanced.customId||(this.config.advanced.id=qe.slug(this.content)),this.$bus.$emit("block-editor-save-block",{id:this.id,config:JSON.parse(C()(this.config)),content:this.content})}}},bt=ft,gt=(n("c1fe"),Object(S["a"])(bt,tt,nt,!1,null,"1be10866",null)),mt=gt.exports,kt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("prism-editor",{ref:"block",class:{"publii-block-html":!0,"is-visible":"code"===e.view},attrs:{code:e.content,emitEvents:!0,lineNumbers:!0,language:"html"},on:{paste:e.pastePlainText,keyup:e.handleKeyboard},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),"preview"===e.view?n("div",{staticClass:"publii-block-html-preview",domProps:{innerHTML:e._s(e.modifiedContent)},on:{click:function(t){return e.setView("code")}}}):e._e(),n("top-menu",{ref:"top-menu",attrs:{conversions:e.conversions,config:[]}})],1)},vt=[],$t=n("0765"),Ct=n.n($t),wt=n("dc81"),yt=n("c3ef"),xt=n.n(yt),It={name:"Html",mixins:[D,$e,Qe],components:{"top-menu":_e},data:function(){return{config:{advanced:{cssClasses:this.getAdvancedConfigDefaultValue("cssClasses"),id:this.getAdvancedConfigDefaultValue("id")}},content:"",conversions:Ct.a}},computed:{modifiedContent:function(){return xt()(this.$refs["block"].code)}},beforeCreate:function(){this.configForm=wt},mounted:function(){this.content=this.inputContent,this.view=""===this.content?"code":"preview"},methods:{focus:function(){this.$refs["block"].$el.querySelector("pre").focus()},handleKeyboard:function(e){"Enter"===e.code&&!0===e.shiftKey&&(e.preventDefault(),this.$bus.$emit("block-editor-add-block","publii-paragraph",this.id),e.returnValue=!1),"Tab"===e.code&&!1===e.shiftKey&&(e.preventDefault(),document.execCommand("insertHTML",!1,"  "),e.returnValue=!1),"Backspace"===e.code&&""===this.$refs["block"].$el.querySelector("pre").innerHTML&&(this.$bus.$emit("block-editor-delete-block",this.id),e.returnValue=!1)},save:function(){this.content=this.$refs["block"].code,this.$bus.$emit("block-editor-save-block",{id:this.id,config:JSON.parse(C()(this.config)),content:this.content})}}},Tt=It,At=(n("49df"),Object(S["a"])(Tt,kt,vt,!1,null,null,null)),St=At.exports,Bt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"publii-block-image-wrapper"},["preview"===e.view||""!==e.content.image?n("figure",{ref:"block",class:{"publii-block-image":!0,"is-wide":"wide"===e.config.imageAlign,"is-full":"full"===e.config.imageAlign}},[n("img",{attrs:{src:e.content.image,height:e.content.imageHeight,width:e.content.imageWidth}}),"code"!==e.view||e.$parent.uiOpened?e._e():n("button",{staticClass:"publii-block-image-delete",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.clearImage()}}},[n("icon",{attrs:{name:"trash"}})],1),""!==e.content.caption&&"preview"===e.view?n("figcaption",[e._v("\n      "+e._s(e.content.caption)+"\n    ")]):e._e()]):e._e(),n("div",{ref:"block",class:{"publii-block-image-form":!0,"is-visible":"code"===e.view}},[""===e.content.image?n("div",{class:{"publii-block-image-uploader":!0,"is-hovered":e.isHovered},on:{drag:function(e){e.stopPropagation(),e.preventDefault()},dragstart:function(e){e.stopPropagation(),e.preventDefault()},dragend:function(e){e.stopPropagation(),e.preventDefault()},dragover:function(t){return t.stopPropagation(),t.preventDefault(),e.dragOver(t)},dragenter:function(e){e.stopPropagation(),e.preventDefault()},dragleave:function(t){return t.stopPropagation(),t.preventDefault(),e.dragLeave(t)},drop:function(t){return t.stopPropagation(),t.preventDefault(),e.drop(t)}}},[n("div",{staticClass:"publii-block-image-uploader-inner"},[e.imageUploadInProgress?e._e():n("icon",{attrs:{name:"blank-image",height:"48",width:"68"}}),e.imageUploadInProgress?e._e():n("span",[e._v("\n          Drop to upload your photo or\n        ")]),e.imageUploadInProgress?e._e():n("button",{on:{click:e.filePickerCallback}},[e._v("\n          Select file\n        ")]),e.imageUploadInProgress?n("span",{staticClass:"publii-block-image-uploader-loader"}):e._e()],1)]):e._e(),n("input",{directives:[{name:"model",rawName:"v-model",value:e.content.caption,expression:"content.caption"}],ref:"contentCaption",attrs:{type:"text",placeholder:"Enter a caption"},domProps:{value:e.content.caption},on:{keydown:e.handleCaptionKeyboard,keyup:e.handleCaretCaption,blur:e.save,input:function(t){t.target.composing||e.$set(e.content,"caption",t.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.content.alt,expression:"content.alt"}],ref:"contentAlt",attrs:{type:"text",placeholder:"Enter alt text"},domProps:{value:e.content.alt},on:{keydown:e.handleAltKeyboard,keyup:e.handleCaretAlt,blur:e.save,input:function(t){t.target.composing||e.$set(e.content,"alt",t.target.value)}}})]),n("top-menu",{ref:"top-menu",attrs:{config:e.topMenuConfig}})],1)},Lt=[],Pt=n("a2a3"),_t={name:"PImage",mixins:[D,$e,Qe,lt],components:{icon:he,"top-menu":_e},data:function(){var e=this;return{caretIsAtStartCaption:!1,caretIsAtEndCaption:!1,caretIsAtStartAlt:!1,caretIsAtEndAlt:!1,isHovered:!1,imageUploadInProgress:!1,config:{imageAlign:"center",link:{url:"",noFollow:!1,targetBlank:!1},advanced:{cssClasses:this.getAdvancedConfigDefaultValue("cssClasses"),id:this.getAdvancedConfigDefaultValue("id")}},content:{image:"",imageHeight:"",imageWidth:"",alt:"",caption:""},topMenuConfig:[{activeState:function(){return"center"===this.config.imageAlign},onClick:function(){this.alignImage("center")},icon:"center"},{activeState:function(){return"wide"===this.config.imageAlign},onClick:function(){this.alignImage("wide")},icon:"wide"},{activeState:function(){return"full"===this.config.imageAlign},onClick:function(){this.alignImage("full")},icon:"full"},{activeState:function(){return""!==e.config.link.url},onClick:this.showLinkPopup,icon:"link"},{activeState:function(){return!1},onClick:this.removeLink,isVisible:function(){return""!==e.config.link.url},icon:"unlink"}]}},computed:{isInsidePublii:function(){return!!document.getElementById("post-editor-fake-image-uploader")}},beforeCreate:function(){this.configForm=Pt},mounted:function(){this.content.image=this.inputContent.image||"",this.content.alt=this.inputContent.alt||"",this.content.caption=this.inputContent.caption||"",this.view=""===this.content.image?"code":"preview",this.initFakeFilePicker(),this.setParentCssClasses(this.config.imageAlign)},methods:{dragOver:function(e){this.isHovered=!0},dragLeave:function(e){this.isHovered=!1},drop:function(e){var t=this;if(this.isInsidePublii){var i=e.dataTransfer.files,o=window.app.$store.state.currentSite.config.name;if(this.imageUploadInProgress=!0,i[0]&&i[0].path){var s=n("bdb9"),a=s.ipcRenderer;a.send("app-image-upload",{id:this.editor.config.postID,site:o,path:i[0].path}),a.once("app-image-uploaded",function(e,n){n.baseImage&&n.baseImage.size&&n.baseImage.size.length>=2?(t.content.imageWidth=n.baseImage.size[0],t.content.imageHeight=n.baseImage.size[1],t.content.image=n.baseImage.url):t.content.image=n.url,t.imageUploadInProgress=!1})}else this.imageUploadInProgress=!1}else{var r=e.dataTransfer.items[0].getAsFile();this.content.image=window.URL.createObjectURL(r)}this.isHovered=!1},initFakeFilePicker:function(){var e=this;if(this.isInsidePublii){var t=n("bdb9"),i=t.ipcRenderer,o=document.getElementById("post-editor-fake-image-uploader");o.addEventListener("change",function(){o.value&&setTimeout(function(){if(e.fileSelectionCallback){var t=!1;o.files&&(t=o.files[0].path),t&&(e.imageUploadInProgress=!0,i.send("app-image-upload",{id:e.postID,site:window.app.$store.state.currentSite.config.name,path:t,imageType:"contentImages"}),i.once("app-image-uploaded",function(t,n){e.content.imageWidth=n.baseImage.size[0],e.content.imageHeight=n.baseImage.size[1],e.content.image=n.baseImage.url,e.fileSelectionCallback=!1,e.imageUploadInProgress=!1}),o.value="")}},50)})}},filePickerCallback:function(){this.fileSelectionCallback=!0,document.getElementById("post-editor-fake-image-uploader").click()},clearImage:function(){this.content.image="",this.isHovered=!1},setView:function(e){var t=this;"code"===this.view&&"preview"===e&&this.save(),this.content.image||"preview"!==e?setTimeout(function(){t.view=e},0):this.view="code"},alignImage:function(e){this.config.imageAlign=e,this.setParentCssClasses(e)},setParentCssClasses:function(e){"full"===e?this.$parent.addCustomCssClass("contains-full-image"):this.$parent.removeCustomCssClass("contains-full-image"),"wide"===e?this.$parent.addCustomCssClass("contains-wide-image"):this.$parent.removeCustomCssClass("contains-wide-image")},focus:function(){var e=this;this.view="code",setTimeout(function(){e.$parent.isSelected||e.setCursorAtEndOfElement("contentCaption",!1)},0)},handleCaptionKeyboard:function(e){"Enter"===e.code&&!1===e.shiftKey&&(this.$refs["contentAlt"].focus(),e.returnValue=!1),"Backspace"===e.code&&""===this.$refs["contentCaption"].value&&""===this.$refs["contentAlt"].value&&(this.$bus.$emit("block-editor-delete-block",this.id),e.returnValue=!1)},handleAltKeyboard:function(e){"Enter"===e.code&&!1===e.shiftKey&&(this.$bus.$emit("block-editor-add-block","publii-paragraph",this.id),e.returnValue=!1),"Backspace"===e.code&&""===this.$refs["contentCaption"].value&&(this.$refs["contentCaption"].focus(),e.returnValue=!1)},handleCaretCaption:function(e){if("ArrowUp"===e.code&&0===this.getCursorPosition("contentCaption")){if(!this.caretIsAtStartCaption)return void(this.caretIsAtStartCaption=!0);var t=this.findPreviousBlockID();t&&(this.editor.$refs["block-wrapper-"+t][0].blockClick(),this.editor.$refs["block-"+t][0].focus())}if("ArrowDown"===e.code&&this.getCursorPosition("contentCaption")>=this.$refs["contentCaption"].value.length-2){if(!this.caretIsAtEndCaption)return void(this.caretIsAtEndCaption=!0);this.$refs["contentAlt"].focus(),e.returnValue=!1}"ArrowDown"!==e.code&&"ArrowUp"!==e.code||(this.caretIsAtStartCaption=!1,this.caretIsAtEndCaption=!1)},handleCaretAlt:function(e){if("ArrowUp"===e.code&&0===this.getCursorPosition("contentAlt")){if(!this.caretIsAtStartAlt)return void(this.caretIsAtStartAlt=!0);this.$refs["contentCaption"].focus(),e.returnValue=!1}if("ArrowDown"===e.code&&this.getCursorPosition("contentAlt")>=this.$refs["contentAlt"].value.length-2){if(!this.caretIsAtEndAlt)return void(this.caretIsAtEndAlt=!0);var t=this.findNextBlockID();t&&(this.editor.$refs["block-wrapper-"+t][0].blockClick(),this.editor.$refs["block-"+t][0].focus("none"))}"ArrowDown"!==e.code&&"ArrowUp"!==e.code||(this.caretIsAtStartAlt=!1,this.caretIsAtEndAlt=!1)},save:function(){this.content.alt=this.$refs["contentAlt"].value,this.content.caption=this.$refs["contentCaption"].value,this.$bus.$emit("block-editor-save-block",{id:this.id,config:JSON.parse(C()(this.config)),content:JSON.parse(C()(this.content))})}}},Mt=_t,Dt=(n("6ced"),Object(S["a"])(Mt,Bt,Lt,!1,null,null,null)),Et=Dt.exports,Ot=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n(e.config.listType,{ref:"block",tag:"component",staticClass:"publii-block-list",attrs:{contenteditable:"true"},domProps:{innerHTML:e._s(e.content)},on:{keyup:function(t){e.getFocusFromTab(t),e.handleCaret(t)},paste:e.pastePlainText,keydown:e.handleKeyboard,mouseup:e.handleMouseUp,blur:e.save}}),n("inline-menu",{ref:"inline-menu"}),n("top-menu",{ref:"top-menu",attrs:{conversions:e.conversions,config:e.topMenuConfig}})],1)},Ht=[],Vt=n("c18e"),Nt=n.n(Vt),Ut=n("c9c1"),Ft=(n("6b54"),{name:"InlineMenu",mixins:[lt,Y],components:{icon:he},data:function(){return{inlineMenuContainer:"block",selectedTextContains:{bold:!1,italic:!1,strikethrough:!1,underline:!1,code:!1,mark:!1,link:!1}}},methods:{handleMouseUp:function(e){var t=this;setTimeout(function(){var e=document.getSelection();e.isCollapsed?t.textIsHighlighted=!1:t.textIsHighlighted=!e.isCollapsed||e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset,t.textIsHighlighted&&setTimeout(function(){t.showInlineMenu()},0)},0)},showInlineMenu:function(){var e=document.getSelection(),t=this.$rangy.saveSelection();this.analyzeSelectedText(e,t),this.$rangy.restoreSelection(t),this.$rangy.removeMarkers(t);var n=e.getRangeAt(0),i=n.getBoundingClientRect(),o=this.$refs[this.inlineMenuContainer].getBoundingClientRect(),s=i.left-o.left+i.width/2+20+"px",a=i.top-o.top-20+"px";this.$refs["inline-menu"].setPosition(s,a),this.$highlighter.removeAllHighlights()},analyzeSelectedText:function(e,t){if(e&&e.anchorNode&&e.focusNode){for(var n=["bold","italic","underline","strikethrough"],i=0;i<n.length;i++)this.selectedTextContains[n[i]]=document.queryCommandState(n[i]);for(var o={code:"code",mark:"mark",a:"link"},s=I()(o),a=this.findTagInSelection(s,t),r=0;r<s.length;r++)this.selectedTextContains[o[s[r]]]=a[s[r]]}},findTagInSelection:function(e,t){if(!t||t.rangeInfos[0].collapsed)return!1;var n=t.rangeInfos[0].startMarkerId,i=t.rangeInfos[0].endMarkerId,o=this.$refs[this.inlineMenuContainer].innerHTML,s=o.split(n)[1];s=s.split(i)[0];for(var a={},r=0;r<e.length;r++)a[e[r]]=s.indexOf("<"+e[r])>-1,!1===a[e[r]]&&this.$refs[this.inlineMenuContainer].querySelector("#"+n).parentNode.tagName===e[r].toUpperCase()&&(a[e[r]]=!0);return a},doInlineOperation:function(e){var t=document.getSelection(),n=this.$rangy.saveSelection();switch(e){case"strong":document.execCommand("bold",!1,null);break;case"em":document.execCommand("italic",!1,null);break;case"s":document.execCommand("strikeThrough",!1,null);break;case"u":document.execCommand("underline",!1,null);break;case"code":this.execCommand("code",n);break;case"mark":this.execCommand("mark",n);break;case"link":this.addLink();break;case"unlink":this.removeLink(n);break;case"indent":this.indentList();break;case"outdent":this.outdentList();break}this.analyzeSelectedText(t,n),this.$rangy.restoreSelection(n),this.$rangy.removeMarkers(n)},execCommand:function(e,t){var n=t.rangeInfos[0].startMarkerId,i=t.rangeInfos[0].endMarkerId,o=document.getElementById(n).nextSibling,s=e.toUpperCase();if(o&&o.tagName===s){var a=['<span id="'+n+'"></span>',document.getSelection().toString().replace(/&nbsp;/gim,""),'<span id="'+i+'"></span>'];document.execCommand("insertHTML",!1,a.join("")),this.selectedTextContains[e]=!1}else{var r=document.getElementById(n).parentNode.tagName,c=this.checkTagPosition(e,n,i);if((-1===c||c>0)&&r!==s){var l=['<span id="'+n+'"></span>',"<"+e+">",document.getSelection().toString().replace(/&nbsp;/gim,""),"</"+e+">",'<span id="'+i+'"></span>'];document.execCommand("insertHTML",!1,l.join("")),this.selectedTextContains[e]=!0}else{var u=document.getSelection();this.wrapElementIntoRangy(u.baseNode,n,i)}}},indentList:function(){var e=this;document.execCommand("indent",!1,null),setTimeout(function(){(e.$refs[e.inlineMenuContainer].innerHTML.indexOf("<ul><ul>")>-1||e.$refs[e.inlineMenuContainer].innerHTML.indexOf("<ol><ol>")>-1)&&document.execCommand("undo",!1,null)},0)},outdentList:function(){document.execCommand("outdent",!1,null)},addLink:function(){var e=document.querySelector(".is-highlighted");e&&(this.linkIsInvalid(this.linkUI.url)&&(this.linkUI.url="https://"+this.linkUI.url),e.outerHTML='<a href="'+this.linkUI.url+'">'+e.innerHTML+"</a>",this.selectedTextContains["link"]=!0)},removeLink:function(e){var t=e.rangeInfos[0].startMarkerId,n=e.rangeInfos[0].endMarkerId,i=['<span id="'+t+'"></span>',document.getSelection().toString().replace(/&nbsp;/gim,""),'<span id="'+n+'"></span>'];document.execCommand("insertHTML",!1,i.join("")),this.selectedTextContains["link"]=!1},checkTagPosition:function(e,t,n){var i=this.$refs[this.inlineMenuContainer].innerHTML.split(t)[1];return i=i.split(n)[0],i.indexOf("<"+e)>-1?i.indexOf("<"+e):-1},wrapElementIntoRangy:function(e,t,n){if("P"!==e.tagName){var i=document.createElement("span");i.setAttribute("id",t);var o=document.createElement("span");o.setAttribute("id",n),document.getElementById(t)&&e.removeChild(document.getElementById(t)),document.getElementById(n)&&e.removeChild(document.getElementById(n)),e.parentNode.insertBefore(i,e),e.parentNode.insertBefore(o,e.nextSibling);var s=e.innerText.replace(/&nbsp;/gim,""),a=this.$refs[this.inlineMenuContainer].innerHTML;a=a.split('<span id="'+t+'"></span>'),a[1]=a[1].split('<span id="'+n+'"></span>');var r=[a[0],'<span id="'+t+'"></span>',s,'<span id="'+n+'"></span>',a[1][1]].join("");this.$refs[this.inlineMenuContainer].innerHTML=r}}}}),jt=Ft,Kt=Object(S["a"])(jt,ht,pt,!1,null,null,null),Rt=Kt.exports,qt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.showInlineMenu?n("div",{key:"inline-menu-"+e.$parent.id,staticClass:"wrapper-ui-inline-menu",style:"left: "+e.left+"; top: "+e.top+";"},[n("div",{staticClass:"wrapper-ui-inline-menu-buttons"},[n("button",{class:{"wrapper-ui-inline-menu-button":!0,"is-active":e.$parent.selectedTextContains.bold},on:{click:function(t){return t.stopPropagation(),e.$parent.doInlineOperation("strong")}}},[n("icon",{attrs:{name:"bold"}})],1),n("button",{class:{"wrapper-ui-inline-menu-button":!0,"is-active":e.$parent.selectedTextContains.italic},on:{click:function(t){return t.stopPropagation(),e.$parent.doInlineOperation("em")}}},[n("icon",{attrs:{name:"italic"}})],1),n("button",{class:{"wrapper-ui-inline-menu-button":!0,"is-active":e.$parent.selectedTextContains.underline},on:{click:function(t){return t.stopPropagation(),e.$parent.doInlineOperation("u")}}},[n("icon",{attrs:{name:"underline"}})],1),n("button",{class:{"wrapper-ui-inline-menu-button":!0,"is-active":e.$parent.selectedTextContains.strikethrough},on:{click:function(t){return t.stopPropagation(),e.$parent.doInlineOperation("s")}}},[n("icon",{attrs:{name:"strikethrough"}})],1),n("button",{class:{"wrapper-ui-inline-menu-button":!0,"is-active":e.$parent.selectedTextContains.link},on:{click:function(t){return t.stopPropagation(),e.$parent.showLinkPopup()}}},[n("icon",{attrs:{name:"link"}})],1),e.$parent.selectedTextContains.link?n("button",{class:{"wrapper-ui-inline-menu-button":!0},on:{click:function(t){return t.stopPropagation(),e.$parent.doInlineOperation("unlink")}}},[n("icon",{attrs:{name:"unlink"}})],1):e._e(),n("button",{class:{"wrapper-ui-inline-menu-button":!0,"is-active":e.$parent.selectedTextContains.code},on:{click:function(t){return t.stopPropagation(),e.$parent.doInlineOperation("code")}}},[n("icon",{attrs:{name:"code"}})],1),n("button",{class:{"wrapper-ui-inline-menu-button":!0,"is-active":e.$parent.selectedTextContains.mark},on:{click:function(t){return t.stopPropagation(),e.$parent.doInlineOperation("mark")}}},[n("icon",{attrs:{name:"marker"}})],1),"publii-list"===e.$parent.$parent.blockType?n("button",{class:{"wrapper-ui-inline-menu-button":!0},on:{click:function(t){return t.stopPropagation(),e.$parent.doInlineOperation("indent")}}},[n("icon",{attrs:{name:"nesting"}})],1):e._e(),"publii-list"===e.$parent.$parent.blockType?n("button",{class:{"wrapper-ui-inline-menu-button":!0},on:{click:function(t){return t.stopPropagation(),e.$parent.doInlineOperation("outdent")}}},[n("icon",{attrs:{name:"flattening"}})],1):e._e()])]):e._e()},Jt=[],Wt={name:"inline-menu-ui",components:{icon:he},computed:{showInlineMenu:function(){return this.$parent.$parent.isSelected&&this.$parent.textIsHighlighted&&!this.$parent.$parent.uiOpened}},watch:{showInlineMenu:function(e,t){e||this.$highlighter.removeAllHighlights()}},data:function(){return{left:"",top:""}},methods:{setPosition:function(e,t){this.left=e,this.top=t}}},zt=Wt,Gt=(n("81bb"),Object(S["a"])(zt,qt,Jt,!1,null,null,null)),Qt=Gt.exports,Zt={name:"List",mixins:[D,Rt],components:{"inline-menu":Qt,"top-menu":_e},data:function(){return{config:{listType:"ul",advanced:{cssClasses:this.getAdvancedConfigDefaultValue("cssClasses"),id:this.getAdvancedConfigDefaultValue("id")}},content:"<li></li>",conversions:Nt.a,topMenuConfig:[{activeState:function(){return"ul"===this.config.listType},onClick:function(){this.setListType("ul")},icon:"unordered-list"},{activeState:function(){return"ol"===this.config.listType},onClick:function(){this.setListType("ol")},icon:"ordered-list"}]}},beforeCreate:function(){this.configForm=Ut},mounted:function(){this.content=this.inputContent,this.inputContent||(this.content="<li></li>")},methods:{handleKeyboard:function(e){"Backspace"!==e.code||"<li></li>"!==this.$refs["block"].innerHTML&&"<li><br></li>"!==this.$refs["block"].innerHTML||(this.$bus.$emit("block-editor-delete-block",this.id),e.returnValue=!1),"Enter"===e.code&&("<li><br></li>"===this.$refs["block"].innerHTML.substr(-13)||"<li></li>"===this.$refs["block"].innerHTML.substr(-9))&&this.$refs["block"].querySelectorAll("li").length>1&&(this.$bus.$emit("block-editor-add-block","publii-paragraph",this.id),this.$refs["block"].innerHTML=this.$refs["block"].innerHTML.substr(0,this.$refs["block"].innerHTML.length-13),e.returnValue=!1)},setListType:function(e){this.save(),this.config.listType=e},save:function(){this.content=this.$refs["block"].innerHTML,this.$bus.$emit("block-editor-save-block",{id:this.id,config:JSON.parse(C()(this.config)),content:this.content})}}},Yt=Zt,Xt=(n("634c"),Object(S["a"])(Yt,Ot,Ht,!1,null,null,null)),en=Xt.exports,tn=function(){var e,t=this,n=t.$createElement,i=t._self._c||n;return i("div",[i("p",{ref:"block",class:(e={"publii-block-paragraph":!0},e[t.config.advanced.style]=!0,e),style:"text-align: "+t.config.textAlign+";",attrs:{slot:"block",contenteditable:"true"},domProps:{innerHTML:t._s(t.content)},on:{focus:t.handleEditFocus,blur:t.handleEditBlur,keyup:function(e){t.getFocusFromTab(e),t.handleKeyUp(e),t.handleCaret(e)},paste:t.pastePlainText,keydown:t.handleKeyboard,mouseup:t.handleMouseUp},slot:"block"}),i("div",{key:"new-block-menu-"+t.id,class:{"publii-block-paragraph-block-selector":!0,"is-visible":t.showNewBlockUI}},[i("button",{staticClass:"publii-block-paragraph-block-selector-list-add-button",attrs:{tabindex:"-1"},on:{click:function(e){return e.stopPropagation(),t.toggleNewBlockUI()}}},[i("icon",{attrs:{name:"add"}})],1),t.newBlockUIListVisible?i("div",{class:{"publii-block-paragraph-block-selector-list":!0,"is-visible":!0}},[i("button",{class:{"publii-block-paragraph-block-selector-list-button":!0,"is-active":0===t.newBlockUIActiveIndex},on:{click:function(e){return e.stopPropagation(),t.addNewBlock("publii-header")}}},[i("icon",{attrs:{name:"headings"}}),0===t.newBlockUIActiveIndex?i("div",{staticClass:"publii-block-paragraph-block-selector-tooltip is-small"},[i("span",{staticClass:"publii-block-paragraph-block-selector-tooltip-label1"},[t._v("\n            Header\n          ")])]):t._e()],1),i("button",{class:{"publii-block-paragraph-block-selector-list-button":!0,"is-active":1===t.newBlockUIActiveIndex},on:{click:function(e){return e.stopPropagation(),t.addNewBlock("publii-image")}}},[i("icon",{attrs:{name:"image"}}),1===t.newBlockUIActiveIndex?i("div",{staticClass:"publii-block-paragraph-block-selector-tooltip is-small"},[i("span",{staticClass:"publii-block-paragraph-block-selector-tooltip-label1"},[t._v("\n            Image\n          ")])]):t._e()],1),i("button",{class:{"publii-block-paragraph-block-selector-list-button":!0,"is-active":2===t.newBlockUIActiveIndex},on:{click:function(e){return e.stopPropagation(),t.addNewBlock("publii-list")}}},[i("icon",{attrs:{name:"unordered-list"}}),2===t.newBlockUIActiveIndex?i("div",{staticClass:"publii-block-paragraph-block-selector-tooltip is-small"},[i("span",{staticClass:"publii-block-paragraph-block-selector-tooltip-label1"},[t._v("\n            List\n          ")])]):t._e()],1),i("button",{class:{"publii-block-paragraph-block-selector-list-button":!0,"is-active":3===t.newBlockUIActiveIndex},on:{click:function(e){return e.stopPropagation(),t.addNewBlock("publii-quote")}}},[i("icon",{attrs:{name:"quote"}}),3===t.newBlockUIActiveIndex?i("div",{staticClass:"publii-block-paragraph-block-selector-tooltip is-small"},[i("span",{staticClass:"publii-block-paragraph-block-selector-tooltip-label1"},[t._v("\n            Quote\n          ")])]):t._e()],1),i("button",{class:{"publii-block-paragraph-block-selector-list-button":!0,"is-active":4===t.newBlockUIActiveIndex},on:{click:function(e){return e.stopPropagation(),t.addNewBlock("publii-code")}}},[i("icon",{attrs:{name:"code"}}),4===t.newBlockUIActiveIndex?i("div",{staticClass:"publii-block-paragraph-block-selector-tooltip is-small"},[i("span",{staticClass:"publii-block-paragraph-block-selector-tooltip-label1"},[t._v("\n            Code\n          ")])]):t._e()],1),i("button",{class:{"publii-block-paragraph-block-selector-list-button":!0,"is-active":5===t.newBlockUIActiveIndex},on:{click:function(e){return e.stopPropagation(),t.addNewBlock("publii-html")}}},[i("icon",{attrs:{name:"html"}}),5===t.newBlockUIActiveIndex?i("div",{staticClass:"publii-block-paragraph-block-selector-tooltip is-small"},[i("span",{staticClass:"publii-block-paragraph-block-selector-tooltip-label1"},[t._v("\n          HTML\n          ")])]):t._e()],1),i("button",{class:{"publii-block-paragraph-block-selector-list-button":!0,"is-active":6===t.newBlockUIActiveIndex},on:{click:function(e){return e.stopPropagation(),t.addNewBlock("publii-separator")}}},[i("icon",{attrs:{name:"separator"}}),6===t.newBlockUIActiveIndex?i("div",{staticClass:"publii-block-paragraph-block-selector-tooltip is-small"},[i("span",{staticClass:"publii-block-paragraph-block-selector-tooltip-label1"},[t._v("\n            Separator\n          ")])]):t._e()],1),t.editor.hasReadMore?t._e():i("button",{class:{"publii-block-paragraph-block-selector-list-button":!0,"is-active":7===t.newBlockUIActiveIndex},on:{click:function(e){return e.stopPropagation(),t.addNewBlock("publii-readmore")}}},[i("icon",{attrs:{name:"readmore"}}),7===t.newBlockUIActiveIndex?i("div",{staticClass:"publii-block-paragraph-block-selector-tooltip is-small"},[i("span",{staticClass:"publii-block-paragraph-block-selector-tooltip-label1"},[t._v("\n            Readmore\n          ")])]):t._e()],1),i("button",{class:{"publii-block-paragraph-block-selector-list-button":!0,"is-active":t.newBlockUIActiveIndex===(t.editor.hasReadMore?7:8)},on:{click:function(e){return e.stopPropagation(),t.addNewBlock("publii-embed")}}},[i("icon",{attrs:{name:"video"}}),t.newBlockUIActiveIndex===(t.editor.hasReadMore?7:8)?i("div",{staticClass:"publii-block-paragraph-block-selector-tooltip is-small"},[i("span",{staticClass:"publii-block-paragraph-block-selector-tooltip-label1"},[t._v("\n            Video\n          ")])]):t._e()],1),i("button",{class:{"publii-block-paragraph-block-selector-list-button":!0,"is-active":t.newBlockUIActiveIndex===(t.editor.hasReadMore?8:9)},on:{click:function(e){return e.stopPropagation(),t.addNewBlock("publii-toc")}}},[i("icon",{attrs:{name:"toc"}}),t.newBlockUIActiveIndex===(t.editor.hasReadMore?8:9)?i("div",{staticClass:"publii-block-paragraph-block-selector-tooltip is-small"},[i("span",{staticClass:"publii-block-paragraph-block-selector-tooltip-label1"},[t._v("\n            TOC\n          ")])]):t._e()],1)]):t._e()]),i("inline-menu",{ref:"inline-menu"}),i("top-menu",{ref:"top-menu",attrs:{conversions:t.conversions,config:t.topMenuConfig}})],1)},nn=[],on=n("d44a"),sn=n.n(on),an=n("87f7"),rn={name:"Paragraph",mixins:[D,$e,Rt],components:{icon:he,"inline-menu":Qt,"top-menu":_e},data:function(){return{config:{textAlign:"left",advanced:{style:this.getAdvancedConfigDefaultValue("style"),cssClasses:this.getAdvancedConfigDefaultValue("cssClasses"),id:this.getAdvancedConfigDefaultValue("id")}},content:"",conversions:sn.a,showNewBlockUI:!1,newBlockUIActiveIndex:0,newBlockUIListVisible:!1,topMenuConfig:[{activeState:function(){return"left"===this.config.textAlign},onClick:function(){this.alignText("left")},icon:"align-left"},{activeState:function(){return"center"===this.config.textAlign},onClick:function(){this.alignText("center")},icon:"align-center"},{activeState:function(){return"right"===this.config.textAlign},onClick:function(){this.alignText("right")},icon:"align-right"}]}},watch:{showNewBlockUI:function(e,t){e?this.$parent.addCustomCssClass("has-block-selector-visible"):this.$parent.removeCustomCssClass("has-block-selector-visible")}},beforeCreate:function(){this.configForm=an},mounted:function(){this.content=this.inputContent,this.$bus.$on("block-editor-deselect-blocks",this.deselectBlock),this.$bus.$on("block-editor-close-new-block-ui",this.hideNewBlockUI)},methods:{refresh:function(){this.$refs["block"].innerHTML=this.content},handleEditFocus:function(){""===this.$refs["block"].innerHTML&&(this.showNewBlockUI=!0)},handleEditBlur:function(e){var t=this;e.relatedTarget&&e.relatedTarget.classList.contains("wrapper-ui-inline-menu-button")||(this.save(),setTimeout(function(){t.newBlockUIListVisible||(t.showNewBlockUI=!1)},250))},handleKeyboard:function(e){if("Enter"===e.code&&!1===e.shiftKey&&!1===this.showNewBlockUI){var t=this.$parent.$parent.extensions.shortcutManager.checkContentForShortcuts(this.$refs["block"].innerHTML);if("publii-readmore"===t&&this.editor.hasReadMore)return window.app?this.$bus.$emit("alert-display",{message:"You can add only one read more per post."}):alert("You can add only one read more per post."),void(e.returnValue=!1);if("publii-paragraph"===t){if(document.execCommand("insertHTML",!1,"<line-separator />"),"<line-separator></line-separator>"===this.$refs["block"].innerHTML.substr(-33))this.$bus.$emit("block-editor-add-block","publii-paragraph",this.id),this.$refs["block"].innerHTML=this.$refs["block"].innerHTML.replace("<line-separator></line-separator>","");else{var n=this.$refs["block"].innerHTML.split("<line-separator></line-separator>"),i=n[0],o=n[1];"<br>"===o.substr(0,4)&&(o=o.substr(4)),this.$refs["block"].innerHTML=i,this.$bus.$emit("block-editor-add-block","publii-paragraph",this.id,o)}this.save()}else this.$bus.$emit("block-editor-add-block",t,this.id),this.$bus.$emit("block-editor-delete-block",this.id);e.returnValue=!1}return"Backspace"===e.code&&""===this.$refs["block"].innerHTML?(this.$bus.$emit("block-editor-delete-block",this.id),void(e.returnValue=!1)):"Backspace"===e.code&&""!==this.$refs["block"].innerHTML&&this.cursorIsAtTheBeginning()?(this.mergeParagraphs(),void(e.returnValue=!1)):"Tab"===e.code&&""===this.$refs["block"].innerHTML&&!1===this.newBlockUIListVisible?(this.toggleNewBlockUI(),this.newBlockUIActiveIndex=0,void(e.returnValue=!1)):"Tab"===e.code&&""===this.$refs["block"].innerHTML&&!0===this.newBlockUIListVisible?(this.newBlockUIActiveIndex++,this.newBlockUIActiveIndex>this.$refs["block"].parentNode.querySelectorAll(".publii-block-paragraph-block-selector-list-button").length-1&&(this.newBlockUIActiveIndex=0),void(e.returnValue=!1)):"Enter"===e.code&&!1===e.shiftKey&&!1===this.newBlockUIListVisible&&!0===this.showNewBlockUI?(this.$bus.$emit("block-editor-add-block","publii-paragraph",this.id),void(e.returnValue=!1)):"Enter"===e.code&&!1===e.shiftKey&&!0===this.newBlockUIListVisible&&!0===this.showNewBlockUI?(this.$refs["block"].parentNode.querySelectorAll(".publii-block-paragraph-block-selector-list-button")[this.newBlockUIActiveIndex].click(),void(e.returnValue=!1)):void(this.blockUIVisible&&(this.blockUIVisible=!1))},handleKeyUp:function(e){this.showNewBlockUI||""!==this.$refs["block"].innerHTML?this.showNewBlockUI&&""!==this.$refs["block"].innerHTML&&(this.showNewBlockUI=!1):this.showNewBlockUI=!0},alignText:function(e){this.config.textAlign=e},mergeParagraphs:function(){var e=this;this.save(),setTimeout(function(){e.$bus.$emit("block-editor-merge-paragraphs",e.id)},0)},save:function(){this.content=this.$refs["block"].innerHTML,this.$bus.$emit("block-editor-save-block",{id:this.id,config:JSON.parse(C()(this.config)),content:this.content})},cursorIsAtTheBeginning:function(){var e=document.getSelection();return 1===e.rangeCount&&0===e.baseOffset},deselectBlock:function(e){e!==this.id&&(this.showNewBlockUI=!1,this.newBlockUIListVisible=!1)},toggleNewBlockUI:function(){this.showNewBlockUI=!0,this.newBlockUIListVisible=!this.newBlockUIListVisible},toggleNewBlockUIIcon:function(){var e=this;setTimeout(function(){e.showNewBlockUI=!0},0)},addNewBlock:function(e){this.$bus.$emit("block-editor-add-block",e,this.id),this.$bus.$emit("block-editor-delete-block",this.id,!1),this.toggleNewBlockUI()},hideNewBlockUI:function(e){this.showNewBlockUI=!1,this.newBlockUIListVisible=!1}},beforeDestroy:function(){this.$bus.$off("block-editor-deselect-blocks",this.deselectBlock),this.$bus.$off("block-editor-close-new-block-ui",this.hideNewBlockUI)}},cn=rn,ln=(n("8adf"),Object(S["a"])(cn,tn,nn,!1,null,null,null)),un=ln.exports,dn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{ref:"block",staticClass:"publii-block-readmore",attrs:{contenteditable:"true"},on:{keyup:function(t){e.getFocusFromTab(t),e.handleCaret(t)},paste:e.pastePlainText}},[n("hr")]),n("top-menu",{ref:"top-menu",attrs:{config:[]}})],1)},hn=[],pn=n("97e0"),fn={name:"ReadMore",mixins:[D],components:{"top-menu":_e},data:function(){return{config:{advanced:{}},content:""}},beforeCreate:function(){this.configForm=pn},mounted:function(){this.$refs["block"].addEventListener("keydown",this.handleKeyboard)},methods:{handleKeyboard:function(e){"Enter"===e.code&&this.$bus.$emit("block-editor-add-block","publii-paragraph",this.id),"Backspace"===e.code&&(this.$bus.$emit("block-editor-delete-block",this.id),e.returnValue=!1),"Tab"!==e.code&&(e.returnValue=!1)},save:function(){this.$bus.$emit("block-editor-save-block",{id:this.id,config:JSON.parse(C()(this.config)),content:this.content})}},beforeDestroy:function(){this.$refs["block"].removeEventListener("keydown",this.handleKeyboard)}},bn=fn,gn=(n("e870"),Object(S["a"])(bn,dn,hn,!1,null,null,null)),mn=gn.exports,kn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{ref:"block",staticClass:"publii-block-separator",attrs:{contenteditable:"true"},on:{keyup:function(t){e.getFocusFromTab(t),e.handleCaret(t)},paste:e.pastePlainText}},[n("hr",{class:e.config.type})]),n("top-menu",{ref:"top-menu",attrs:{conversions:e.conversions,config:e.topMenuConfig}})],1)},vn=[],$n=n("4a13"),Cn=n.n($n),wn=n("d4a7"),yn={name:"Separator",mixins:[D],components:{"top-menu":_e},data:function(){return{config:{type:"dots",advanced:{cssClasses:this.getAdvancedConfigDefaultValue("cssClasses"),id:this.getAdvancedConfigDefaultValue("id")}},content:"",topMenuConfig:[{activeState:function(){return"long"===this.config.type},onClick:function(){this.setType("long")},icon:"long-line"},{activeState:function(){return"dots"===this.config.type},onClick:function(){this.setType("dots")},icon:"dotted-line"},{activeState:function(){return"dot"===this.config.type},onClick:function(){this.setType("dot")},icon:"dot"}],conversions:Cn.a}},beforeCreate:function(){this.configForm=wn},mounted:function(){this.$refs["block"].addEventListener("keydown",this.handleKeyboard)},methods:{handleKeyboard:function(e){"Enter"===e.code&&(this.$bus.$emit("block-editor-add-block","publii-paragraph",this.id),e.returnValue=!1),"Backspace"===e.code&&(this.$bus.$emit("block-editor-delete-block",this.id),e.returnValue=!1),"Tab"!==e.code&&(e.returnValue=!1)},setType:function(e){this.config.type=e},save:function(){this.$bus.$emit("block-editor-save-block",{id:this.id,config:JSON.parse(C()(this.config)),content:this.content})}},beforeDestroy:function(){this.$refs["block"].removeEventListener("keydown",this.handleKeyboard)}},xn=yn,In=(n("eb90"),Object(S["a"])(xn,kn,vn,!1,null,null,null)),Tn=In.exports,An=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{ref:"block",staticClass:"publii-block-toc-wrapper"},[n("h2",{ref:"title",staticClass:"publii-block-toc-title",attrs:{contenteditable:"true"},domProps:{innerHTML:e._s(e.content.title)},on:{keydown:e.handleKeyboard,keyup:function(t){return e.handleCaret(t,"title")},blur:e.save}}),n("ol",{ref:"content",staticClass:"publii-block-toc",domProps:{innerHTML:e._s(e.content.toc)}})]),n("top-menu",{ref:"top-menu",attrs:{config:[]}})],1)},Sn=[],Bn=n("8c22"),Ln={name:"ToC",mixins:[D],components:{"top-menu":_e},data:function(){return{focusable:["title"],config:{advanced:{cssClasses:this.getAdvancedConfigDefaultValue("cssClasses"),id:this.getAdvancedConfigDefaultValue("id")}},content:{title:"",toc:""}}},computed:{},beforeCreate:function(){this.configForm=Bn},mounted:function(){this.content.toc=this.inputContent.toc,this.content.title=this.inputContent.title,this.updateToc(),this.$bus.$on("block-editor-content-updated",this.updateToc),this.$bus.$on("block-editor-block-selected",this.selectBlock)},methods:{handleKeyboard:function(e){"Enter"===e.code&&(this.$bus.$emit("block-editor-add-block","publii-paragraph",this.id),e.returnValue=!1),"Backspace"===e.code&&""===this.$refs["title"].innerHTML&&(this.$bus.$emit("block-editor-delete-block",this.id),e.returnValue=!1)},updateToc:function(){var e=this.$parent.$parent.content.filter(function(e){return"publii-header"===e.type});if(0!==e.length){var t,n,i="",o=2;if(!e.length)return"";for(var s=0;s<e.length;s++){t=e[s];var a=t.config.headingLevel||2;if(e[s+1]&&(n=e[s+1].config.headingLevel),o===a)i+="<li>";else for(var r=o;r<a;r++)i+="<ol><li>";if(i+='<a href="#'+t.config.advanced.id+'">'+t.content+"</a>",n&&n!==a)for(var c=a;c>n;c--)i+="</li></ol><li>";else i+="</li>",n||(i+="</ol>");o=a}this.content.toc=i.replace(/<li>[\s]*?<\/li>/gim,"")}else this.content.toc=""},selectBlock:function(e){this.id===e&&this.focus("end")},save:function(){this.content={toc:this.$refs["content"].innerHTML,title:this.$refs["title"].innerHTML},this.$bus.$emit("block-editor-save-block",{id:this.id,config:JSON.parse(C()(this.config)),content:JSON.parse(C()(this.content))})}},beforeDestroy:function(){this.$bus.$off("block-editor-content-updated",this.updateToc),this.$bus.$off("block-editor-block-selected",this.selectBlock)}},Pn=Ln,_n=(n("14f1"),Object(S["a"])(Pn,An,Sn,!1,null,null,null)),Mn=_n.exports,Dn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"publii-block-quote-wrapper"},[n("div",{ref:"block",class:{"publii-block-quote-form":!0,"is-visible":"code"===e.view}},[n("div",{ref:"contentText",staticClass:"publii-block-quote-text",attrs:{contenteditable:"true"},domProps:{innerHTML:e._s(e.content.text)},on:{keyup:function(t){e.getFocusFromTab(t),e.handleCaretText(t)},keydown:e.handleTextKeyboard,blur:e.save,paste:e.pastePlainText,mouseup:e.handleMouseUp}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.content.author,expression:"content.author"}],ref:"contentAuthor",attrs:{type:"text",placeholder:"Quote author"},domProps:{value:e.content.author},on:{keyup:function(t){return e.handleCaretAuthor(t)},keydown:e.handleAuthorKeyboard,blur:e.save,input:function(t){t.target.composing||e.$set(e.content,"author",t.target.value)}}})]),"preview"===e.view?n("figure",{ref:"block",staticClass:"publii-block-quote"},[n("blockquote",{domProps:{innerHTML:e._s(e.content.text)}}),n("figcaption",{domProps:{innerHTML:e._s(e.content.author)}})]):e._e()]),n("inline-menu",{ref:"inline-menu"}),n("top-menu",{ref:"top-menu",attrs:{conversions:e.conversions,config:[]}})],1)},En=[],On=n("0784"),Hn=n.n(On),Vn=n("5ab1"),Nn={name:"Paragraph",mixins:[D,$e,Qe,Rt],components:{"inline-menu":Qt,"top-menu":_e},data:function(){return{focusable:["contentText","contentAuthor"],caretIsAtStartText:!1,caretIsAtEndText:!1,caretIsAtStartAuthor:!1,caretIsAtEndAuthor:!1,config:{advanced:{cssClasses:this.getAdvancedConfigDefaultValue("cssClasses"),id:this.getAdvancedConfigDefaultValue("id")}},content:{text:"",author:""},conversions:Hn.a,inlineMenuContainer:"contentText"}},watch:{view:function(e,t){"code"===t&&"preview"===e&&this.setCursorAtEndOfElement("contentText",!0)}},beforeCreate:function(){this.configForm=Vn},mounted:function(){this.content.text=this.inputContent.text,this.content.author=this.inputContent.author,this.view=this.content.text||this.content.author?"preview":"code"},methods:{handleTextKeyboard:function(e){"Backspace"===e.code&&""===this.$refs["contentText"].value&&""===this.$refs["contentAuthor"].value&&(this.$bus.$emit("block-editor-delete-block",this.id),e.returnValue=!1)},handleAuthorKeyboard:function(e){"Enter"===e.code&&!1===e.shiftKey&&(this.$bus.$emit("block-editor-add-block","publii-paragraph",this.id),e.returnValue=!1),"Backspace"===e.code&&""===this.$refs["contentAuthor"].value&&(this.$refs["contentText"].focus(),e.returnValue=!1)},handleCaretText:function(e){if("ArrowUp"===e.code&&0===this.getCursorPosition("contentText")){if(!this.caretIsAtStartText)return void(this.caretIsAtStartText=!0);var t=this.findPreviousBlockID();t&&(this.editor.$refs["block-wrapper-"+t][0].blockClick(),this.editor.$refs["block-"+t][0].focus())}if("ArrowDown"===e.code&&this.getCursorPosition("contentText")>=this.$refs["contentText"].innerHTML.length-2){if(!this.caretIsAtEndText)return void(this.caretIsAtEndText=!0);this.$refs["contentAuthor"].focus(),e.returnValue=!1}"ArrowDown"!==e.code&&"ArrowUp"!==e.code||(this.caretIsAtStartText=!1,this.caretIsAtEndText=!1)},handleCaretAuthor:function(e){if("ArrowUp"===e.code&&0===this.getCursorPosition("contentAuthor")){if(!this.caretIsAtStartAuthor)return void(this.caretIsAtStartAuthor=!0);this.$refs["contentText"].focus(),e.returnValue=!1}if("ArrowDown"===e.code&&this.getCursorPosition("contentAuthor")>=this.$refs["contentAuthor"].value.length-2){if(!this.caretIsAtEndAuthor)return void(this.caretIsAtEndAuthor=!0);var t=this.findNextBlockID();t&&(this.editor.$refs["block-wrapper-"+t][0].blockClick(),this.editor.$refs["block-"+t][0].focus("none"))}"ArrowDown"!==e.code&&"ArrowUp"!==e.code||(this.caretIsAtStartAuthor=!1,this.caretIsAtEndAuthor=!1)},setView:function(e){var t=this;"code"===this.view&&"preview"===e&&this.save(),this.content.text||"preview"!==e?setTimeout(function(){t.view=e},0):this.view="code"},save:function(){this.content.text=this.$refs["contentText"].innerHTML,this.content.author=this.$refs["contentAuthor"].value,this.$bus.$emit("block-editor-save-block",{id:this.id,config:JSON.parse(C()(this.config)),content:JSON.parse(C()(this.content))})}}},Un=Nn,Fn=(n("dd02"),Object(S["a"])(Un,Dn,En,!1,null,null,null)),jn=Fn.exports,Kn=n("d225"),Rn=n("b0b4"),qn=function(){function e(){Object(Kn["a"])(this,e),this.shortcuts={},this.initDefaultShortcuts(),this.initMarkdownDefaultShortcuts()}return Object(Rn["a"])(e,[{key:"initDefaultShortcuts",value:function(){this.shortcuts["/separator"]="publii-separator",this.shortcuts["/hr"]="publii-separator",this.shortcuts["/header"]="publii-header",this.shortcuts["/h1"]="publii-header-1",this.shortcuts["/h2"]="publii-header-2",this.shortcuts["/h3"]="publii-header-3",this.shortcuts["/h4"]="publii-header-4",this.shortcuts["/h5"]="publii-header-5",this.shortcuts["/h6"]="publii-header-6",this.shortcuts["/list"]="publii-list",this.shortcuts["/quote"]="publii-quote",this.shortcuts["/blockquote"]="publii-quote",this.shortcuts["/code"]="publii-code",this.shortcuts["/readmore"]="publii-readmore",this.shortcuts["/more"]="publii-readmore",this.shortcuts["/html"]="publii-html",this.shortcuts["/toc"]="publii-toc",this.shortcuts["/embed"]="publii-embed",this.shortcuts["/image"]="publii-image",this.shortcuts["/img"]="publii-image"}},{key:"initMarkdownDefaultShortcuts",value:function(){this.shortcuts["---"]="publii-separator",this.shortcuts["***"]="publii-readmore",this.shortcuts["#"]="publii-header-1",this.shortcuts["##"]="publii-header-2",this.shortcuts["###"]="publii-header-3",this.shortcuts["####"]="publii-header-4",this.shortcuts["#####"]="publii-header-5",this.shortcuts["######"]="publii-header-6",this.shortcuts["*"]="publii-list",this.shortcuts[">"]="publii-quote",this.shortcuts["```"]="publii-code"}},{key:"checkContentForShortcuts",value:function(e){return""!==e&&e.length<24&&this.shortcuts[e]?this.shortcuts[e]:"publii-paragraph"}},{key:"add",value:function(e,t){this.shortcuts[e]?console.warn("The following shortcut is already defined: "+e+" for the following block: "+this.shortcuts[e]):this.shortcuts[e]=t}}]),e}(),Jn=function(){function e(){Object(Kn["a"])(this,e)}return Object(Rn["a"])(e,[{key:"stripTags",value:function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.innerText;return n}}]),e}(),Wn={name:"BlockEditor",components:{"block-advanced-config":J,"block-link-popup":oe,"block-wrapper":ge,"publii-code":Oe,"publii-embed":et,"publii-header":mt,"publii-html":St,"publii-image":Et,"publii-list":en,"publii-paragraph":un,"publii-readmore":mn,"publii-separator":Tn,"publii-toc":Mn,"publii-quote":jn},computed:{hasReadMore:function(){return this.content.filter(function(e){return"publii-readmore"===e.type}).length>0}},data:function(){return{config:{postID:""},state:{selectedBlockID:!1,externalComponentsLoaded:!1},internal:{lastScroll:0},extensions:{shortcutManager:new qn,conversionHelpers:new Jn},content:[{id:1555941466744,type:"publii-paragraph",content:"",config:{}}]}},watch:{content:{handler:function(e){this.$bus.$emit("block-editor-content-updated")},deep:!0}},beforeMount:function(){var e=this,t=document.createElement("script");t.setAttribute("src","external-component.js"),document.body.appendChild(t),setTimeout(function(){e.state.externalComponentsLoaded=!0},500)},mounted:function(){this.$self=this,d["a"].prototype.$rangy.init(),this.$bus.$on("block-editor-move-block-up",this.moveBlockUp),this.$bus.$on("block-editor-move-block-down",this.moveBlockDown),this.$bus.$on("block-editor-save-block",this.saveBlock),this.$bus.$on("block-editor-delete-block",this.deleteBlock),this.$bus.$on("block-editor-add-block",this.addNewBlock),this.$bus.$on("block-editor-merge-paragraphs",this.mergeParagraphs),this.$bus.$on("block-editor-shortcut-manager-add-shortcut",this.extensions.shortcutManager.add),this.$bus.$on("block-editor-ui-opened-for-block",this.uiOpenedForBlock),this.$bus.$on("block-editor-ui-closed-for-block",this.uiClosedForBlock),this.$bus.$on("block-editor-convert-block",this.convertBlock),this.$bus.$on("publii-block-editor-save",this.saveAllBlocks),this.$bus.$on("publii-block-editor-load",this.loadAllBlocks),this.initGlobals()},methods:{initGlobals:function(){window.Vue=d["a"],window.publiiBlockEditor={},window.publiiBlockEditor.Block=D,window.publiiBlockEditor.compileToFunctions=Ce["compileToFunctions"],window.publiiBlockEditor.ContentEditableImprovements=$e},moveBlockUp:function(e,t){var n=this.content.findIndex(function(t){return t.id===e});if(n>0){var i=JSON.parse(C()(this.content[n]));d["a"].set(this.content,n,this.content[n-1]),d["a"].set(this.content,n-1,i)}this.scrollWindow(e,t)},moveBlockDown:function(e,t){var n=this.content.findIndex(function(t){return t.id===e});if(n<this.content.length-1){var i=JSON.parse(C()(this.content[n]));d["a"].set(this.content,n,this.content[n+1]),d["a"].set(this.content,n+1,i)}this.scrollWindow(e,t)},scrollWindow:function(e,t){var n=this;+new Date<this.internal.lastScroll+100||(this.internal.lastScroll=+new Date,this.$nextTick(function(){var i=n.$refs["block-wrapper-"+e][0].$refs["block-wrapper"].getBoundingClientRect().top;window.scrollBy(0,i-t)}))},saveBlock:function(e){var t=this.content.findIndex(function(t){return t.id===e.id});t>-1&&(this.content[t].content=e.content,this.content[t].config=e.config)},deleteBlock:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.content.findIndex(function(t){return t.id===e});this.content.splice(n,1),this.state.selectedBlockID=!1,n>0&&t&&this.$refs["block-"+this.content[n-1].id][0].focus(),this.content.length||this.addNewBlock("publii-paragraph",!1),this.$refs["editor-main"].setAttribute("data-ui-opened-block","")},addNewBlock:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=this.content.findIndex(function(e){return e.id===n}),s={};if(this.$bus.$emit("block-editor-deselect-blocks"),n||(o=-1),0===e.indexOf("publii-header-")){var a=v()(e.replace("publii-header-",""),10);s.headingLevel=a,e="publii-header"}var r=+new Date,c={id:r,type:e,content:i,config:s};this.content.splice(o+1,0,c),setTimeout(function(){if("publii-readmore"===e||"publii-separator"===e){var n=t.content.findIndex(function(e){return e.id===r});if(n===t.content.length-1)t.addNewParagraphAtEnd();else{var o=n+1,s=t.content[o].id;t.$refs["block-"+s][0].focus("end"),t.$bus.$emit("block-editor-block-selected",s)}}else""===i?t.$refs["block-"+r][0].focus("end"):t.$refs["block-"+r][0].focus("start")},50)},addNewParagraphAtEnd:function(){var e=this.content.length-1,t=this.content[e];if(t){if("publii-paragraph"===t.type&&""===t.content){var n=t.id;return this.$refs["block-"+n][0].focus(),void this.$refs["block-"+n][0].toggleNewBlockUIIcon()}this.addNewBlock("publii-paragraph",t.id)}else this.addNewBlock("publii-paragraph",!1)},mergeParagraphs:function(e){var t=this,n=this.content.findIndex(function(t){return t.id===e});if(0!==n){var i=this.content[n-1].type,o=this.content[n-1].id;"publii-paragraph"===i?(this.content[n-1].content=this.content[n-1].content+'<span class="temp-paragraph-merge-caret"></span>'+this.content[n].content,this.content.splice(n,1),setTimeout(function(){t.$refs["block-"+o][0].content=t.content[n-1].content,t.$refs["block-"+o][0].refresh(),setTimeout(function(){var e=document.createRange(),n=t.$refs["block-"+o][0].$refs["block"].querySelector(".temp-paragraph-merge-caret");t.$refs["block-"+o][0].focus("none");var i=document.getSelection();setTimeout(function(){e.selectNodeContents(n),e.deleteContents(),i.removeAllRanges(),i.addRange(e),i.baseNode.parentNode.removeChild(i.baseNode)},0)},0)},0)):this.$refs["block-"+o][0].focus("end")}},uiClosedForBlock:function(e){this.$refs["editor-main"].setAttribute("data-ui-opened-block","")},uiOpenedForBlock:function(e){this.$refs["editor-main"].setAttribute("data-ui-opened-block",e)},loadAllBlocks:function(){var e=document.querySelector("#post-editor");""!==e.value&&(this.content=JSON.parse(e.value))},saveAllBlocks:function(){var e=document.querySelector("#post-editor"),t=!0,n=!1,i=void 0;try{for(var o,s=m()(this.content);!(t=(o=s.next()).done);t=!0){var a=o.value;this.$refs["block-"+a.id][0].save()}}catch(r){n=!0,i=r}finally{try{t||null==s.return||s.return()}finally{if(n)throw i}}e.value=C()(this.content)},setPostID:function(e){this.config.postID=e},convertBlock:function(e,t,n){var i=this.content.findIndex(function(t){return t.id===e});d["a"].set(this.content,i,{id:e,type:t,content:n.content,config:JSON.parse(C()(n.config))})}},beforeDestroy:function(){this.$bus.$off("block-editor-move-block-up",this.moveBlockUp),this.$bus.$off("block-editor-move-block-down",this.moveBlockDown),this.$bus.$off("block-editor-save-block",this.saveBlock),this.$bus.$off("block-editor-delete-block",this.deleteBlock),this.$bus.$off("block-editor-add-block",this.addNewBlock),this.$bus.$off("block-editor-merge-paragraphs",this.mergeParagraphs),this.$bus.$off("block-editor-shortcut-manager-add-shortcut",this.extensions.shortcutManager.add),this.$bus.$off("block-editor-ui-opened-for-block",this.uiOpenedForBlock),this.$bus.$off("block-editor-ui-closed-for-block",this.uiClosedForBlock),this.$bus.$off("block-editor-convert-block",this.convertBlock),this.$bus.$off("publii-block-editor-save",this.saveAllBlocks),this.$bus.$off("publii-block-editor-load",this.loadAllBlocks)}},zn=Wn,Gn=(n("3708"),Object(S["a"])(zn,f,b,!1,null,null,null)),Qn=Gn.exports,Zn=n("692c"),Yn=n.n(Zn);n("2cbc"),n("62ac"),n("1fb3");d["a"].prototype.$bus||(window.app&&window.app.$bus?d["a"].prototype.$bus=window.app.$bus:d["a"].prototype.$bus=new d["a"]),d["a"].prototype.$rangy||(d["a"].prototype.$rangy=Yn.a);var Xn={name:"publii-block-editor",components:{BlockEditor:Qn},mounted:function(){window.publiiBlockEditorInstance=this,d["a"].prototype.$highlighter||(d["a"].prototype.$highlighter=this.$rangy.createHighlighter()),this.$highlighter.addClassApplier(this.$rangy.createClassApplier("is-highlighted",{ignoreWhiteSpace:!0,tagNames:["span","a"]}))},methods:{setPostID:function(e){this.$refs["block-editor"].setPostID(e)}}},ei=Xn,ti=Object(S["a"])(ei,h,p,!1,null,null,null),ni=ti.exports,ii=(n("c197"),n("431a")),oi=n.n(ii);n("fdfb"),n("d69f"),n("fb8e"),n("7175"),n("55ec"),n("b785"),n("c891"),n("997e"),n("9d22"),n("320f"),n("5577"),n("31e4"),n("8dd4"),n("46a4"),n("b2fc"),n("dd5a"),n("253f"),n("0981"),n("ab3c"),n("3d2a"),n("42ea"),n("53e0"),n("add7"),n("d8d9"),n("17ca"),n("f14e"),n("803e"),n("b387"),n("c7db"),n("f066"),n("f88c"),n("cd6e"),n("aa45"),n("7ed1"),n("f6c7"),n("5a6b"),n("b4fe"),n("de8f"),n("bf38"),n("3733"),n("c98a"),n("ae68"),n("8406"),n("8fd1"),n("2a83"),n("923b"),n("3376"),n("1e5b"),n("70cb"),n("a8a9"),n("a395"),n("0469"),n("1db9"),n("1f11"),n("e31e"),n("e14f"),n("cd2b");d["a"].config.productionTip=!1,d["a"].component("prism-editor",oi.a),new d["a"]({render:function(e){return e(ni)}}).$mount("#app")},"5ab1":function(e){e.exports=[{name:"cssClasses",type:"text",label:"CSS class",tooltip:"This CSS classes will be added as the class attribute of the field",defaultValue:""},{name:"id",type:"text",label:"ID",tooltip:"This value will be used as ID of the paragraph",defaultValue:""}]},"621e":function(e,t,n){},"634c":function(e,t,n){"use strict";var i=n("2871"),o=n.n(i);o.a},6422:function(e,t,n){},"6ced":function(e,t,n){"use strict";var i=n("4ac6"),o=n.n(i);o.a},"6dbe":function(e,t,n){"use strict";var i=n("9d07"),o=n.n(i);o.a},"75ab":function(e,t,n){},"7ce2":function(e){e.exports=[{name:"cssClasses",type:"text",label:"CSS class",tooltip:"This CSS classes will be added as the class attribute of the field",defaultValue:""},{name:"customId",type:"checkbox",label:"Use custom ID",tooltip:"Enable this option if you want to use own ID, instead of the auto-generated one",defaultValue:!1},{name:"id",type:"text",label:"ID",tooltip:"This value will be used as ID of the paragraph",defaultValue:"",disabled:[{field:"customId",value:!1}]}]},"7d22":function(e,t,n){},"7e0a":function(e,t,n){},"81bb":function(e,t,n){"use strict";var i=n("7d22"),o=n.n(i);o.a},"87f7":function(e){e.exports=[{name:"cssClasses",type:"text",label:"CSS class",tooltip:"This CSS classes will be added as the class attribute of the field",defaultValue:""},{name:"style",type:"select",label:"Paragraph style",tooltip:"Select additional styling for the paragraph block",values:[{value:"warning",label:"Warning"},{value:"alert",label:"Alert"},{value:"info",label:"Info"}],defaultValue:""},{name:"id",type:"text",label:"ID",tooltip:"This value will be used as ID of the paragraph",defaultValue:""}]},"8adf":function(e,t,n){"use strict";var i=n("75ab"),o=n.n(i);o.a},"8bb7":function(e,t,n){},"8c22":function(e){e.exports=[{name:"cssClasses",type:"text",label:"CSS class",tooltip:"This CSS classes will be added as the class attribute of the field",defaultValue:""},{name:"id",type:"text",label:"ID",tooltip:"This value will be used as ID of the paragraph",defaultValue:""}]},"97e0":function(e){e.exports=[]},"98b9":function(e,t){const n=[{icon:"paragraph",name:"Paragraph",type:"publii-paragraph",convert:function(e,t,n){let i=n.extensions.conversionHelpers.stripTags(t).replace(/\n/gim,"<br>"),o={textAlign:"left",advanced:{style:"",cssClasses:e.advanced.cssClasses,id:e.advanced.id}};return{content:i,config:o}}},{icon:"html",name:"HTML",type:"publii-html",convert:function(e,t,n,i){let o=t,s={advanced:{cssClasses:e.advanced.cssClasses,id:e.advanced.id}};return{content:o,config:s}}}];e.exports=n},9901:function(e,t,n){},"9d07":function(e,t,n){},a2a3:function(e){e.exports=[{name:"cssClasses",type:"text",label:"CSS class",tooltip:"This CSS classes will be added as the class attribute of the field",defaultValue:""},{name:"id",type:"text",label:"ID",tooltip:"This value will be used as ID of the paragraph",defaultValue:""}]},ad08:function(e,t,n){},bcbe:function(e,t,n){},c18e:function(e,t){const n=[{icon:"paragraph",name:"Paragraph",type:"publii-paragraph",convert:function(e,t,n){let i=n.extensions.conversionHelpers.stripTags(t.replace(/<\/li><li>/gim,"\n")).replace(/\n/gim,"<br>"),o={textAlign:"left",advanced:{style:"",cssClasses:e.advanced.cssClasses,id:e.advanced.id}};return{content:i,config:o}}},{icon:"html",name:"HTML",type:"publii-html",convert:function(e,t,n,i){let o=i.outerHTML.replace(/<ul.*?>/gim,"<ul>").replace(/<ol.*?>/gim,"<ol>").replace(/<\/li><li>/gim,"</li>\n<li>").replace(/ul><li>/gim,"ul>\n<li>").replace(/ol><li>/gim,"ol>\n<li>").replace(/<\/li><\/ul>/gim,"</li>\n</ul>"),s={advanced:{cssClasses:e.advanced.cssClasses,id:e.advanced.id}};return{content:o,config:s}}}];e.exports=n},c1fe:function(e,t,n){"use strict";var i=n("2533"),o=n.n(i);o.a},c3ef:function(e,t){function n(e){return e=e.replace(/&gt;/gim,">"),e=e.replace(/&lt;/gim,"<"),e=e.replace(/&nbsp;/gim,"&"),e=e.replace(/<script/gim,"<publii-script"),e=e.replace(/<\/script/gim,"</publii-script"),e=e.replace(/<iframe/gim,"<publii-iframe"),e=e.replace(/<\/iframe/gim,"</publii-iframe"),e}e.exports=n},c4c4:function(e,t,n){},c9c1:function(e){e.exports=[{name:"cssClasses",type:"text",label:"CSS class",tooltip:"This CSS classes will be added as the class attribute of the field",defaultValue:""},{name:"id",type:"text",label:"ID",tooltip:"This value will be used as ID of the paragraph",defaultValue:""}]},cb24:function(e,t){const n=[{icon:"paragraph",name:"Paragraph",type:"publii-paragraph",convert:function(e,t,n){let i=n.extensions.conversionHelpers.stripTags(t.replace(/<br>/gim,"\n")).replace(/\n/gim,"<br>"),o={textAlign:e.textAlign,advanced:{style:"",cssClasses:e.advanced.cssClasses,id:e.advanced.id}};return{content:i,config:o}}},{icon:"html",name:"HTML",type:"publii-html",convert:function(e,t,n,i){let o=i.outerHTML.replace(/<h([0-9]{1,1}).*?>/gim,"<h$1>"),s={advanced:{cssClasses:e.advanced.cssClasses,id:e.advanced.id}};return{content:o,config:s}}}];e.exports=n},ce2f:function(e,t,n){},d44a:function(e,t){const n=[{icon:"headings",name:"Header",type:"publii-header",convert:function(e,t,n){let i=n.extensions.conversionHelpers.stripTags(t.replace(/<br>/gim,"\n")).replace(/\n/gim,"<br>"),o={headingLevel:2,textAlign:e.textAlign,link:{url:"",noFollow:!1,targetBlank:!1},advanced:{cssClasses:e.advanced.cssClasses,customId:!1,id:e.advanced.id}};return{content:i,config:o}}},{icon:"quote",name:"Quote",type:"publii-quote",convert:function(e,t,n){let i={advanced:{cssClasses:e.advanced.cssClasses,id:e.advanced.id}};return{content:{text:t,author:""},config:i}}},{icon:"unordered-list",name:"List",type:"publii-list",convert:function(e,t,n){let i="<li>"+t.split("<br>").join("</li><li>")+"</li>",o={listType:"ul",advanced:{cssClasses:e.advanced.cssClasses,id:e.advanced.id}};return{content:i,config:o}}},{icon:"code",name:"Code",type:"publii-code",convert:function(e,t,n){let i=n.extensions.conversionHelpers.stripTags(t.replace(/<br>/gim,"\n")),o={language:"html",advanced:{cssClasses:e.advanced.cssClasses,id:e.advanced.id}};return{content:i,config:o}}},{icon:"html",name:"HTML",type:"publii-html",convert:function(e,t,n,i){let o=i.outerHTML.replace(/<p.*?>/gim,"<p>"),s={advanced:{cssClasses:e.advanced.cssClasses,id:e.advanced.id}};return{content:o,config:s}}}];e.exports=n},d4a7:function(e){e.exports=[{name:"cssClasses",type:"text",label:"CSS class",tooltip:"This CSS classes will be added as the class attribute of the field",defaultValue:""},{name:"id",type:"text",label:"ID",tooltip:"This value will be used as ID of the paragraph",defaultValue:""}]},d7eb:function(e,t,n){},dbd0:function(e,t,n){"use strict";var i=n("4cee"),o=n.n(i);o.a},dc81:function(e){e.exports=[{name:"cssClasses",type:"text",label:"CSS class",tooltip:"This CSS classes will be added as the class attribute of the field",defaultValue:""},{name:"id",type:"text",label:"ID",tooltip:"This value will be used as ID of the paragraph",defaultValue:""}]},dd02:function(e,t,n){"use strict";var i=n("7e0a"),o=n.n(i);o.a},ded4:function(e,t,n){},e19f:function(e,t,n){"use strict";var i=n("ce2f"),o=n.n(i);o.a},e870:function(e,t,n){"use strict";var i=n("c4c4"),o=n.n(i);o.a},e98d:function(e,t,n){"use strict";var i=n("8bb7"),o=n.n(i);o.a},eb90:function(e,t,n){"use strict";var i=n("d7eb"),o=n.n(i);o.a},f23b:function(e,t,n){"use strict";var i=n("27d2"),o=n.n(i);o.a},f9d7:function(e){e.exports=[{name:"cssClasses",type:"text",label:"CSS class",tooltip:"This CSS classes will be added as the class attribute of the field",defaultValue:""},{name:"id",type:"text",label:"ID",tooltip:"This value will be used as ID of the paragraph",defaultValue:""}]}});
//# sourceMappingURL=app.205a4fcb.js.map